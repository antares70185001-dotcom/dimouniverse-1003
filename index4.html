<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë””ëª¨ ë°œëª… ì¹´ë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700;800&display=swap" rel="stylesheet">

  <style>
    :root{ --main:#5cab6d; --accent:#a5e6b8; --bg:#f8fff9; --shadow:0 12px 40px rgba(0,0,0,0.3); }
    *{ box-sizing:border-box; }
    body{ font-family:"Noto Sans KR","Arial",sans-serif; background:var(--bg); text-align:center; margin:0; padding:20px; }
    .screen{ display:none; } .screen.active{ display:block; }

    .btn{ background:var(--accent); border:none; padding:14px 28px; border-radius:28px; cursor:pointer; font-size:18px; font-weight:700; color:#1f3b2b; margin:12px; transition:.2s; touch-action:manipulation;}
    .btn:hover{ background:#8ed8a3; transform:translateY(-1px); }

    video{ width:780px; max-width:100%; border-radius:20px; margin:20px auto; display:block; box-shadow:var(--shadow); }
    #resultScreen > video{ display:none !important; }

    .title{ font-family:'Jua',sans-serif; font-size:58px; font-weight:800; margin:12px 0 10px; color:#5cab6d; }

    .section-title{ font-family:'Jua',sans-serif; font-size:28px; font-weight:700; color:#2d4d38; margin:10px auto 6px; width:100%; max-width:680px; text-align:left; }
    form{ background:#fff; border-radius:20px; padding:30px; display:flex; flex-direction:column; text-align:left; max-width:680px; width:100%; margin:20px auto; box-shadow:0 6px 20px rgba(0,0,0,0.08); border:3px solid var(--accent);}
    .form-group{ margin-bottom:20px; }
    label{ font-weight:bold; font-size:17px; color:#000; display:block; margin-bottom:8px; }
    input,textarea,select{ width:100%; padding:12px; border-radius:10px; border:2px solid #d3f2db; font-size:15px; background:#fafffa; transition:border .2s, box-shadow .2s; }
    input:focus,textarea:focus,select:focus{ outline:none; border:2px solid var(--main); box-shadow:0 0 8px rgba(92,171,109,.3); }
    textarea{ min-height:110px; }

    .celebration-card{ background:#ffffff; border:3px solid var(--accent); border-radius:20px; padding:16px 16px 56px; max-width:720px; margin:12px auto; box-shadow:0 8px 24px rgba(0,0,0,.12); position:relative; width:100%; overflow:hidden; will-change:transform; transform:translateZ(0);}
    .banner{ font-family:'Jua',sans-serif; font-size:32px; font-weight:900; margin:0 0 8px 0; text-align:center; width:100%; background:linear-gradient(90deg,#5cab6d,#3c9d9b,#6a5acd); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; color:transparent; text-shadow:2px 2px 6px rgba(0,0,0,.08); }
    .card-body{ display:grid; grid-template-columns:auto 1fr; gap:14px; align-items:center; }
    .dimo-left{ width:clamp(108px,26vw,160px); height:auto; border-radius:16px; flex-shrink:0; align-self:center; object-fit:contain; margin:0 auto; }
    .ratings-wrap{ flex:1; min-width:0; text-align:left; }
    .rating{ display:flex; justify-content:space-between; align-items:center; background:#f9fffb; border:2px solid #d3f2db; border-radius:10px; padding:8px 12px; margin:6px 0; white-space:nowrap; }
    .rating h3{ margin:0; font-size:clamp(13px,3.8vw,16px); font-weight:700; color:#2d4d38; flex:1; white-space:nowrap; }
    .stars{ display:flex; gap:4px; white-space:nowrap; font-size:clamp(18px,5vw,26px); cursor:pointer; }
    .star{ position:relative; color:#d8d8d8; will-change:transform; }
    .star.full{ color:#ffcc00; text-shadow:1px 1px 6px rgba(255,204,0,.7); }
    .star.half::before{ content:"â˜…"; position:absolute; left:0; top:0; width:50%; overflow:hidden; color:#ffcc00; text-shadow:1px 1px 6px rgba(255,204,0,.7); }

    @keyframes dimo-twinkle{ 0%{ transform:scale(1) rotate(0); filter: drop-shadow(0 0 0 rgba(255,204,0,0)); } 50%{ transform:scale(1.15) rotate(-5deg); filter: drop-shadow(0 0 8px rgba(255,204,0,.7)); } 100%{ transform:scale(1) rotate(0); filter: drop-shadow(0 0 0 rgba(255,204,0,0)); } }
    .stars.twinkle .star.full, .stars.twinkle .star.half { animation: dimo-twinkle 600ms ease both; }

    .idea-info{ margin-top:12px; font-size:clamp(14px,4vw,18px); font-weight:bold; color:#333; text-align:center; background:#f9fffb; padding:10px 14px; border-radius:16px; border:2px solid #d3f2db; max-width:720px; margin-left:auto; margin-right:auto; line-height:1.8; word-break:keep-all; overflow-wrap:anywhere; display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; }
    .idea-info strong{ color:var(--main); }
    .idea-info .info-item{ display:inline-flex; align-items:center; gap:6px; }
    .idea-info .sep{ opacity:.4; }

    .celebration-card .actions{ display:flex; gap:8px; justify-content:center; margin-top:10px; flex-wrap:wrap; }
    .btn-save{ background:linear-gradient(135deg,#bff3c8 0%, #8de0d3 100%); color:#103a30; border:none; font-weight:800; box-shadow:0 6px 16px rgba(0,0,0,.08); }

    #stampArea{ position:absolute; inset:0; pointer-events:none; }
    .stamp-wrap{ position:absolute; }
    .stamp-img{ width:100%; display:block; transform-origin:center; filter: drop-shadow(0 6px 12px rgba(0,0,0,.10)); }
    .impact,.ink{ position:absolute; inset:0; pointer-events:none; }
    .impact{ border:6px solid rgba(0,0,0,.14); border-radius:50%; transform:scale(0); opacity:0; }
    .ink{ background: radial-gradient(ellipse at center, rgba(0,0,0,.15) 0%, rgba(0,0,0,0) 70%); opacity:0; transform:scale(.8); }

    .stamp-enter{ animation: stamp-pop 520ms cubic-bezier(.18,1.4,.22,1) forwards; }
    @keyframes stamp-pop{ 0%{ opacity:0; transform: translateY(-16px) scale(1.35) rotate(var(--r,-4deg)); filter: blur(1px) drop-shadow(0 24px 36px rgba(0,0,0,.18)); } 65%{ opacity:1; transform: translateY(0) scale(.97) rotate(var(--r,-4deg)); filter: drop-shadow(0 10px 18px rgba(0,0,0,.14)); } 100%{ transform: scale(1) rotate(var(--r,-4deg)); filter: drop-shadow(0 6px 12px rgba(0,0,0,.10)); } }
    @keyframes impact-wave{ 0%{ transform:scale(0); opacity:0; } 30%{ transform:scale(1); opacity:.35; } 100%{ transform:scale(1.35); opacity:0; } }
    @keyframes ink-spread{ 0%{ opacity:0; transform:scale(.8); } 100%{ opacity:.5; transform:scale(1.1); } }
    .hit .impact{ animation: impact-wave 420ms ease-out 80ms forwards; }
    .hit .ink{ animation: ink-spread 700ms ease-out 60ms forwards; }

    .celebration-card.paper-jolt{ animation: paper-jolt 220ms cubic-bezier(.3,.7,.4,1) 1; }
    @keyframes paper-jolt{ 0%{ transform: translateY(0) rotate(0); } 30%{ transform: translateY(1px) rotate(-0.25deg); } 60%{ transform: translateY(0) rotate(0.15deg); } 100%{ transform: translateY(0) rotate(0); } }

    .banner{ font-size:clamp(22px,6.5vw,32px); line-height:1.15; word-break:keep-all; }
    @media (max-width: 480px){
      body{ padding:12px; }
      .title{ font-size: 34px; margin: 8px 0; }
      .celebration-card{ padding:12px 12px 52px; }
      .card-body{ gap:10px; }
      .rating{ padding:10px 12px; }
      .idea-info{ flex-direction:column; gap:6px; }
      .idea-info .sep{ display:none; }
    }

    .toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:calc(20px + env(safe-area-inset-bottom, 0px)); background:#2c7a4c; color:#fff; padding:12px 16px; border-radius:10px; font-weight:700; box-shadow:0 8px 18px rgba(0,0,0,.15); opacity:0; visibility:hidden; transition:opacity .25s ease, visibility .25s ease; z-index:9999;}
    .toast.show{ opacity:1; visibility:visible; }

    .save-fixed{ position:fixed; left:50%; transform:translateX(-50%); bottom:calc(84px + env(safe-area-inset-bottom, 0px)); z-index:9998; }

    .card-footer-logo{ position:absolute; right:16px; bottom:12px; font-family:'Orbitron',sans-serif; font-weight:900; letter-spacing:1.5px; font-size:14px; opacity:.55; user-select:none; }

    .particle{ position:fixed; pointer-events:none; will-change: transform, opacity; font-size:24px; opacity:0; }
    @keyframes float-up{ 0%{ transform: translate(0,0) scale(.9) rotate(0deg); opacity:0; } 10%{ opacity:1; } 100%{ transform: translate(var(--dx,0px), var(--dy,-120px)) scale(1.2) rotate(var(--rot,20deg)); opacity:0; } }

    .celebration-card.glow{ animation: card-glow 2.4s ease-in-out infinite alternate; }
    @keyframes card-glow{ 0%{ box-shadow: 0 8px 24px rgba(0,0,0,.12), 0 0 0px rgba(92,171,109,0.0); } 100%{ box-shadow: 0 8px 24px rgba(0,0,0,.12), 0 0 22px rgba(92,171,109,0.35); } }

    .stamp-bubble{ position:absolute; left:0; top:0; transform: translate(-6px,-6px); background:rgba(255,255,255,.95); border:2px solid #a5e6b8; border-radius:14px; padding:4px 10px; font-weight:900; color:#246244; box-shadow:0 6px 14px rgba(0,0,0,.08); opacity:0; animation: bubble-pop 900ms ease-out forwards; font-family:'Jua',sans-serif; font-size:14px; white-space:nowrap; }
    @keyframes bubble-pop{ 0%{ transform: translate(-6px,4px) scale(.9); opacity:0; } 40%{ transform: translate(-6px,-6px) scale(1.02); opacity:1; } 100%{ transform: translate(-6px,-18px) scale(1); opacity:0; } }

    .star.fillping{ animation: fillping .38s ease-out; }
    @keyframes fillping{ 0%{ transform: scale(.6) rotate(-8deg); filter: drop-shadow(0 0 0 rgba(255,204,0,0)); } 60%{ transform: scale(1.25) rotate(0); filter: drop-shadow(0 0 10px rgba(255,204,0,.7)); } 100%{ transform: scale(1); } }

    @media (prefers-reduced-motion: reduce){ .celebration-card.glow{ animation:none; } }

    /* ====== ADD: íŒŒìŠ¤í…” íŒ¨í„´, ìŠ¬ë¡œê±´, ë²„íŠ¼ ìŠ¤íŒŒí´ ====== */
    .pattern {
      position: fixed; inset: 0; z-index: -1; pointer-events: none; opacity: .65;
      background:
        radial-gradient(circle at 12% 15%, rgba(165,230,184,.25) 0 140px, transparent 150px),
        radial-gradient(circle at 88% 25%, rgba(169,214,255,.22) 0 120px, transparent 130px),
        radial-gradient(circle at 18% 85%, rgba(255,214,232,.22) 0 140px, transparent 150px),
        radial-gradient(circle at 80% 82%, rgba(255,234,167,.20) 0 130px, transparent 140px);
      animation: dimo-bg-move 28s linear infinite;
    }
    @keyframes dimo-bg-move {
      0% { background-position: 0 0, 0 0, 0 0, 0 0; }
      100% { background-position: 600px 360px, -520px 480px, 300px -420px, -300px 300px; }
    }

    .slogan{
      font-family:'Baloo 2','Jua',cursive; font-size:clamp(28px,7.6vw,68px); font-weight:900;
      margin:6px auto 14px; background:linear-gradient(90deg,#A5E6B8,#A9D6FF,#FFD6E8,#FFEAA7,#A5E6B8);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-size:300% auto;
      text-shadow:0 4px 10px rgba(0,0,0,.12); animation:dimo-shine 6s linear infinite;
    }
    @keyframes dimo-shine { 0%{background-position:0% center} 100%{background-position:100% center} }

    .intro-bubble{
      display:inline-block; background:#fff; color:#246244; border:2px solid #a5e6b8;
      padding:8px 12px; border-radius:16px; font-family:'Jua',sans-serif; font-weight:900;
      box-shadow:0 8px 16px rgba(0,0,0,.08); margin:6px 0 0; animation:dimo-bob 3s ease-in-out infinite;
    }
    @keyframes dimo-bob { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }

    .btn.sugar{ position:relative; overflow:hidden; }
    .btn.sugar::after{
      content:""; position:absolute; left:-40%; top:-120%; width:180%; height:340%;
      background:
        radial-gradient(circle, rgba(255,255,255,.85) 0 2px, transparent 3px) 0 0/18px 18px,
        radial-gradient(circle, rgba(255,255,255,.6) 0 1.5px, transparent 2.5px) 9px 9px/18px 18px;
      transform:rotate(25deg); opacity:0; animation:sugar-sweep 3.6s ease-in-out infinite;
    }
    @keyframes sugar-sweep { 0%{opacity:0; transform:translateX(-20%) rotate(25deg)} 20%{opacity:.4} 60%{opacity:.15} 100%{opacity:0; transform:translateX(40%) rotate(25deg)} }
    .btn.pulse{ animation:pulse-btn .6s ease } @keyframes pulse-btn{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}

    .dimo-say{
      margin:10px auto 0; display:inline-flex; align-items:center; gap:8px; background:#fff; border:2px solid #d3f2db;
      border-radius:16px; padding:8px 12px; color:#2d4d38; font-weight:900; font-family:'Jua',sans-serif; box-shadow:0 6px 16px rgba(0,0,0,.06);
    }
    .float-chip{ display:inline-block; padding:6px 10px; border-radius:12px; margin:6px 4px 0;
      background:linear-gradient(145deg, rgba(169,214,255,.25), rgba(255,234,167,.25)); font-weight:700; color:#3b7f59; box-shadow:0 4px 10px rgba(0,0,0,.06);
      animation:chip-hop 2.4s ease-in-out infinite;
    }
    @keyframes chip-hop {0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}

    /* ====== ADD: ìƒë‹¨ ì»¨íŠ¸ë¡¤ë°” / í…Œë§ˆ / Calm ëª¨ë“œ / ì‹œìŠ¤í…œ ê³µìœ  FAB ====== */
    .topbar{
      position:fixed; right:12px; top:12px; z-index:10000; display:flex; gap:8px; align-items:center; flex-wrap:wrap;
      background:rgba(255,255,255,.9); border:2px solid #d3f2db; border-radius:14px; padding:8px 10px; box-shadow:0 8px 18px rgba(0,0,0,.08);
      font-family:'Jua',sans-serif; user-select:none;
    }
    .sw{ display:flex; align-items:center; gap:6px; font-weight:900; color:#2d4d38; }
    .sw input{ appearance:none; width:40px; height:22px; border-radius:999px; background:#dfe; position:relative; outline:none; cursor:pointer; }
    .sw input:checked{ background:#bfe3c9; }
    .sw input::after{ content:""; position:absolute; top:3px; left:3px; width:16px; height:16px; border-radius:50%; background:#fff; box-shadow:0 1px 3px rgba(0,0,0,.2); transition:transform .2s; }
    .sw input:checked::after{ transform:translateX(18px); }

    .themes{ display:flex; gap:6px; align-items:center; }
    .dot{ width:18px; height:18px; border-radius:50%; border:2px solid #fff; box-shadow:0 2px 5px rgba(0,0,0,.12); cursor:pointer; }
    .dot[data-theme="mint"]{ background:linear-gradient(135deg,#a5e6b8,#a9d6ff); }
    .dot[data-theme="candy"]{ background:linear-gradient(135deg,#ffd6e8,#ffeaa7); }
    .dot[data-theme="ocean"]{ background:linear-gradient(135deg,#a9d6ff,#9ee3e0); }

    .share-fab{
      position:fixed; right:14px; bottom:calc(84px + env(safe-area-inset-bottom,0px));
      z-index:10000; width:54px; height:54px; border-radius:50%; border:none; cursor:pointer;
      background:#ffffff; box-shadow:0 8px 18px rgba(0,0,0,.15); font-size:22px;
    }

    body.calm *{ animation-play-state:paused !important; transition:none !important; }
    body.calm .pattern{ animation:none !important; }
    body.calm .celebration-card.glow{ animation:none !important; }

    body.theme-mint{ --main:#5cab6d; --accent:#a5e6b8; --bg:#f8fff9; }
    body.theme-candy{ --main:#d96dab; --accent:#ffd6e8; --bg:#fff8fb; }
    body.theme-ocean{ --main:#3f8fc9; --accent:#a9d6ff; --bg:#f6fbff; }
  </style>
</head>
<body>

  <!-- Pattern BG -->
  <div class="pattern" aria-hidden="true"></div>

  <!-- ìƒë‹¨ ì»¨íŠ¸ë¡¤ë°” -->
  <div class="topbar" role="group" aria-label="í™˜ê²½ì„¤ì •">
    <div class="sw" title="ì‚¬ìš´ë“œ">
      ğŸ”ˆ <input type="checkbox" id="soundToggle" checked aria-label="ì‚¬ìš´ë“œ í† ê¸€">
    </div>
    <div class="sw" title="ì €ìê·¹ ëª¨ë“œ">
      ğŸŒ™ <input type="checkbox" id="motionToggle" checked aria-label="ëª¨ì…˜ í† ê¸€">
    </div>
    <div class="themes" aria-label="í…Œë§ˆ ì„ íƒ">
      ğŸ¨
      <button class="dot" data-theme="mint"   title="ë¯¼íŠ¸"></button>
      <button class="dot" data-theme="candy"  title="ìº”ë””"></button>
      <button class="dot" data-theme="ocean"  title="ì˜¤ì…˜"></button>
    </div>
  </div>

  <!-- 1) ì¸íŠ¸ë¡œ -->
  <div id="introScreen" class="screen active">
    <h1 class="title">ë””ëª¨ì˜ ë°œëª… ì–´ë“œë²¤ì³</h1>
    <h2 class="slogan">âœ¨ ìƒìƒì€ ì •ë‹µì„ ë„˜ëŠ”ë‹¤ âœ¨</h2>
    <button id="goFormBtn" class="btn sugar">â–¶ ë””ëª¨ ë§Œë‚˜ëŸ¬ ê°€ê¸°</button>
    <video autoplay muted loop playsinline webkit-playsinline><source src="dimo.mp4" type="video/mp4"></video>
    <div class="intro-bubble">ë””ëª¨ê°€ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘â€¦ ğŸ‘‹</div>
    <audio id="intro1" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬1.mp3" preload="auto"></audio>
    <audio id="intro2" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬2.mp3" preload="auto"></audio>
    <audio id="intro3" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬3.mp3" preload="auto"></audio>
    <audio id="intro4" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬4.mp3" preload="auto"></audio>
  </div>

  <!-- 2) ì„¤ë¬¸ -->
  <div id="formScreen" class="screen">
    <h2 class="section-title">ğŸ“£ ë””ëª¨ì—ê²Œ ì•Œë ¤ì¤˜</h2>
    <form id="ideaForm" novalidate>
      <div class="form-group">
        <label>1. ë””ëª¨ëŠ” ì¹œêµ¬ ë‚˜ì´ê°€ ê¶ê¸ˆí•´! *</label>
        <div class="float-chip">ğŸ‚ ë‚˜ì´</div>
        <select id="age" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="8">8ì„¸</option><option value="9">9ì„¸</option><option value="10">10ì„¸</option>
          <option value="11">11ì„¸</option><option value="12">12ì„¸</option><option value="13">13ì„¸</option>
          <option value="14">14ì„¸</option><option value="15">15ì„¸</option><option value="16">16ì„¸</option>
          <option value="17">17ì„¸</option><option value="18">18ì„¸</option><option value="19">19ì„¸</option>
        </select>
      </div>

      <div class="form-group">
        <label>2. ë””ëª¨ì—ê²Œ ë„ˆë§Œì˜ ë©‹ì§„ ë³„ëª…ì„ ì •í•´ì¤˜! (ì‹¤ëª…ë§ê³  ë³„ëª…ìœ¼ë¡œ) *</label>
        <div class="float-chip">ğŸ¤– ë³„ëª…</div>
        <input type="text" id="nickname" placeholder="ì˜ˆ: ë°œëª…ì™• ë””ëª¨!" required>
      </div>

      <div class="form-group">
        <label>3. í‰ì†Œì— "ì•„~ ì´ê±° ë¶ˆí¸í•˜ë‹¤!" ì‹¶ì—ˆë˜ ìˆœê°„ì´ ìˆì—ˆì–´? ë””ëª¨í•œí…Œ ë§í•´ì¤„ë˜? *</label>
        <div class="float-chip">ğŸ˜– ë¶ˆí¸í•œ ìˆœê°„</div>
        <textarea id="problem" placeholder="ì˜ˆ: ì—°í•„ì´ ìê¾¸ êµ´ëŸ¬ê°€ì„œ ìƒì–´ë²„ë ¤ìš”" required></textarea>
      </div>

      <div class="form-group">
        <label>4. ê·¸ ë¶ˆí¸ì„ í•´ê²°í•  ë©‹ì§„ ë°œëª…í’ˆ ì´ë¦„ì„ ë”±! ì§€ì–´ë³¼ê¹Œ? *</label>
        <div class="float-chip">ğŸ’¡ ë°œëª…í’ˆ ì´ë¦„</div>
        <input type="text" id="ideaName" placeholder="ì˜ˆ: ì•ˆ êµ´ëŸ¬ê°€ëŠ” ì—°í•„" required>
      </div>

      <div class="form-group">
        <label>5. ì´ ë°œëª…í’ˆì€ ì–´ë–»ê²Œ ì‘ë™í•˜ê³  ì–´ë–¤ì ì´ í¸ë¦¬í•´ ì§€ëŠ”ê±°ì•¼? *</label>
        <div class="float-chip">âš™ï¸ ì‘ë™ ì›ë¦¬</div>
        <textarea id="ideaDetail" placeholder="ì˜ˆ: ì—°í•„ì— ì‘ì€ ìì„ì´ ë¶™ì–´ì„œ ì±…ìƒì— ë”± ë‹¬ë¼ ë¶™ì–´ìš”. ê·¸ë˜ì„œ ì§€ìš°ê°œë¥¼ ì˜ ìŠì–´ë²„ë¦¬ì§€ ì•Šê³  í•„ìš”í•  ë•Œë§ˆë‹¤ ì“¸ ìˆ˜ ìˆì–´ìš”." required></textarea>
        <div class="char-count" style="text-align:right;"><span id="charCount">0</span>ì</div>
        <div class="char-count">30ìâ†‘ ê¸°ë³¸ / 40ìâ†‘ <strong>ë§Œì  4%</strong> / 50ìâ†‘ <strong>ë ˆì–´ 5%</strong>(ë§Œì  ì‹¤íŒ¨ ì‹œ)</div>
      </div>

      <div class="form-group">
        <label>6. (ì„ íƒ) ë³´í˜¸ì ì´ë©”ì¼ (êµ¿ì¦ˆ ë‹¹ì²¨ ì‹œ ì•ˆë‚´ìš©)</label>
        <div class="float-chip">ğŸ“§ ë³´í˜¸ì ì—°ë½</div>
        <input type="email" id="parentEmail" placeholder="ì˜ˆ: parent@example.com" inputmode="email">
      </div>

      <div id="consentWrap" class="form-group privacy-check" style="display:none">
        <input type="checkbox" id="consent">
        <label for="consent">ì‘ì„±í•˜ì‹  ì´ë©”ì¼ì€ <strong>ë‹¹ì²¨ ì•ˆë‚´ì—ë§Œ ì‚¬ìš©</strong>ë˜ë©°, í–‰ì‚¬ ì¢…ë£Œ í›„ <strong>ì¦‰ì‹œ íŒŒê¸°</strong>ë©ë‹ˆë‹¤.</label>
      </div>

      <p class="privacy-note">â€» ë³´í˜¸ì ì´ë©”ì¼ì€ <strong>êµ¿ì¦ˆ ì´ë²¤íŠ¸ ì°¸ì—¬ë¥¼ í¬ë§í•  ê²½ìš°ì—ë§Œ</strong> ì‘ì„±í•˜ì„¸ìš”. ì…ë ¥í•˜ì§€ ì•Šì•„ë„ ì•„ì´ë””ì–´ ì œì¶œê³¼ ìŠ¤íƒ¬í”„ íšë“ì€ ì •ìƒ ì§„í–‰ë©ë‹ˆë‹¤.</p>
      <button type="submit" class="btn">ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°</button>
    </form>

    <!-- ì…ë ¥ ì•ˆë‚´ ì˜¤ë””ì˜¤(1íšŒ ì¬ìƒ) -->
    <audio id="hintNickname"   src="ë³„ëª…ì•ˆë‚´ë©˜íŠ¸.mp3" preload="auto"></audio>
    <audio id="hintProblem"    src="ë¶ˆí¸í•œì ì•ˆë‚´ë©˜íŠ¸.mp3" preload="auto"></audio>
    <audio id="hintIdeaDetail" src="ì•„ì´ë””ì–´ì„¤ëª…ë©˜íŠ¸.mp3" preload="auto"></audio>
  </div>

  <!-- 3) ê²°ê³¼ -->
  <div id="resultScreen" class="screen">
    <video autoplay muted loop playsinline webkit-playsinline><source src="dimo.mp4" type="video/mp4"></video>

    <div id="celebrationArea" class="celebration-card">
      <h2 class="banner">ë‚˜ë§Œì˜ ì•„ì´ë””ì–´ ì¹´ë“œ</h2>
      <div class="card-body">
        <img id="dimoImage" src="" alt="ë””ëª¨ ìºë¦­í„°" class="dimo-left">
        <div class="ratings-wrap">
          <div class="rating"><h3>ë°˜ì§ì´ëŠ” ìƒìƒë ¥</h3><div id="creativity" class="stars"></div></div>
          <div class="rating"><h3>ì •ë§ ë ê¹Œ? ì ìˆ˜</h3><div id="feasibility" class="stars"></div></div>
          <div class="rating"><h3>ë””ëª¨ì˜ ê¸°ìˆ ë ¥ ë ˆë²¨</h3><div id="technical" class="stars"></div></div>
        </div>
      </div>

      <div id="ideaInfo" class="idea-info">
        <span class="info-item">ğŸ‘¤ <strong>ë°œëª…ì:</strong> <span id="inventorName"></span></span>
        <span class="sep" aria-hidden="true">|</span>
        <span class="info-item">ğŸ’¡ <strong>ë‚´ ë°œëª…í’ˆ:</strong> <span id="ideaDisplay"></span></span>
      </div>

      <div class="actions"></div>
      <div class="dimo-say">ğŸ¤– <i>ì¢‹ì•˜ì–´!</i> ì˜¤ëŠ˜ë„ <i>ë°œëª… ëª¨í—˜</i> ì´ì–´ê°€ì ğŸ’</div>

      <div class="card-footer-logo">DIMO UNIVERSE</div>
      <div id="stampArea"></div>
    </div>

    <div class="save-fixed"><button id="shareBtn" class="btn btn-save" aria-label="ì¹´ë“œ ì €ì¥í•˜ê¸°">ğŸ¨ ì¹´ë“œ ì €ì¥í•˜ê¸°</button></div>
    <button id="sysShareBtn" class="share-fab" title="ì‹œìŠ¤í…œ ê³µìœ ">ğŸ“¤</button>

    <div id="particleLayer" aria-hidden="true"></div>

    <!-- ì¹­ì°¬ ì˜¤ë””ì˜¤(ëœë¤ í’€) -->
    <audio id="compliment1" src="ë””ëª¨ì¹­ì°¬01.mp3" preload="auto"></audio>
    <audio id="compliment2" src="ë””ëª¨ì¹­ì°¬02.mp3" preload="auto"></audio>
    <audio id="compliment3" src="ë””ëª¨ì¹­ì°¬03.mp3" preload="auto"></audio>
    <audio id="compliment4" src="ë””ëª¨ì¹­ì°¬04.mp3" preload="auto"></audio>
    <audio id="compliment5" src="ë””ëª¨ì¹­ì°¬05.mp3" preload="auto"></audio>
    <audio id="compliment6" src="ë””ëª¨ ì¹­ì°¬ ë©”ì‹œì§€.mp3" preload="auto"></audio>
    <!-- (ë³´ìœ  íŒŒì¼ ìœ ì§€í•˜ë˜ ëœë¤ì—ëŠ” ì‚¬ìš© ì•ˆ í•¨) -->
    <audio id="audioPerfect" src="ë§Œì ìš©ì¹­ì°¬.mp3" preload="auto"></audio>
    <audio id="audioRare" src="í–‰ìš´ì˜ë ˆì–´í…œì¹­ì°¬.mp3" preload="auto"></audio>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">ğŸ“¥ ì•¨ë²”ì— ì €ì¥ë˜ì—ˆì–´ìš”!</div>

  <!-- Libs -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <!-- ====== ê¸°ì¡´ ë¡œì§ ìŠ¤í¬ë¦½íŠ¸ (ê·¸ëŒ€ë¡œ ìœ ì§€) ====== -->
  <script>
    const MOBILE = window.matchMedia('(max-width: 480px), (pointer: coarse)').matches;
    const STAR_STEP_MS = 260;
    const dimoImages = ["dimo01.png","dimo02.png","dimo03.png","dimo04.png"];

    function playOne(a){ if(!a) return Promise.resolve(false); try{ a.currentTime=0; a.muted=false; return a.play().then(()=>true).catch(()=>false);}catch(e){ return Promise.resolve(false);} }

    async function unlockAudios(ids){
      for(const id of ids){
        const a=document.getElementById(id); if(!a) continue;
        try{
          a.load();
          const vol=a.volume; a.volume=0.001;
          await a.play(); a.pause(); a.currentTime=0; a.volume=vol;
        }catch(e){}
      }
    }

    function sprayParticlesAroundCard(durationMs=2400){
      const card=document.getElementById('celebrationArea'); if(!card) return;
      const rect=card.getBoundingClientRect(); const emojis=["â­","ğŸ’–","ğŸˆ","âœ¨"];
      const start=performance.now(); const burst=MOBILE?3:4; const interval=MOBILE?190:160;
      function spawnOne(){
        const el=document.createElement('div'); el.className='particle'; el.textContent=emojis[Math.floor(Math.random()*emojis.length)];
        const x=rect.left+Math.random()*rect.width, y=rect.top+Math.random()*rect.height; el.style.left=x+'px'; el.style.top=y+'px';
        const dx=(Math.random()*160-80).toFixed(0), dy=(-(100+Math.random()*140)).toFixed(0), rot=(Math.random()*120-60).toFixed(0)+'deg';
        el.style.setProperty('--dx',dx+'px'); el.style.setProperty('--dy',dy+'px'); el.style.setProperty('--rot',rot);
        el.style.animation='float-up 2.2s ease-out forwards'; document.body.appendChild(el); setTimeout(()=>el.remove(),2300);
      }
      const timer=setInterval(()=>{ for(let i=0;i<burst;i++) spawnOne(); if(performance.now()-start>durationMs) clearInterval(timer); }, interval);
    }

    (function setupIntro(){
      const btn=document.getElementById('goFormBtn'); const introScreen=document.getElementById('introScreen'); const formScreen=document.getElementById('formScreen');
      const intros=["intro1","intro2","intro3","intro4"].map(id=>document.getElementById(id)).filter(Boolean);
      let locked=false;
      btn.addEventListener('click', ()=>{
        if(locked) return; locked=true; btn.disabled=true; btn.style.opacity=.7; btn.style.cursor='default';
        const pick=arr=>arr[Math.floor(Math.random()*arr.length)]; const audio=intros.length?pick(intros):null;
        const GUARD_MS=12000; let guard=setTimeout(()=>gotoForm(),GUARD_MS);
        function gotoForm(){ clearTimeout(guard); introScreen.classList.remove('active'); formScreen.classList.add('active'); document.getElementById('ideaDetail')?.focus(); }
        if(!audio){ setTimeout(gotoForm,2500); return; }
        try{ audio.currentTime=0; audio.muted=false; const p=audio.play(); if(p&&typeof p.then==='function'){ p.then(()=>{ audio.onended=()=>setTimeout(gotoForm,2000); }).catch(()=>setTimeout(gotoForm,2500)); } else { audio.onended=()=>setTimeout(gotoForm,2000); } }catch(e){ setTimeout(gotoForm,2500); }
      }, {passive:true});
    })();

    (function setupFormHelpers(){
      const detail=document.getElementById('ideaDetail'); const charCount=document.getElementById('charCount');
      const parentEmail=document.getElementById('parentEmail'); const consentWrap=document.getElementById('consentWrap'); const consent=document.getElementById('consent');
      function updateLen(){ const len=(detail.value||'').trim().length; charCount.textContent=len; }
      detail.addEventListener('input', updateLen, {passive:true}); updateLen();
      function syncConsent(){ const hasEmail=(parentEmail.value||'').trim().length>0; consentWrap.style.display=hasEmail?'flex':'none'; if(hasEmail){ consent.setAttribute('required','required'); }else{ consent.removeAttribute('required'); consent.checked=false; } }
      parentEmail.addEventListener('input', syncConsent, {passive:true}); syncConsent();

      const onceOpts={ once:true, passive:true };
      const hintNickname=document.getElementById('hintNickname'); const hintProblem=document.getElementById('hintProblem'); const hintIdeaDetail=document.getElementById('hintIdeaDetail');
      document.getElementById('nickname').addEventListener('click', ()=>playOne(hintNickname), onceOpts);
      document.getElementById('problem').addEventListener('click', ()=>playOne(hintProblem), onceOpts);
      document.getElementById('ideaDetail').addEventListener('click', ()=>playOne(hintIdeaDetail), onceOpts);
    })();

    function animateStarsToScore(id, score){
      return new Promise(resolve=>{
        const el=document.getElementById(id); if(!el) return resolve();
        el.innerHTML='<span class="star">â˜…</span>'.repeat(5);
        const full=Math.floor(score); const hasHalf=(score-full)>=0.5; let idx=0, target=full+(hasHalf?1:0);
        (function step(){
          if(idx>=target){ setTimeout(resolve, 400); return; }
          const s=el.children[idx];
          if(idx<full){ s.classList.add('full','fillping'); } else if(hasHalf){ s.classList.add('half','fillping'); }
          idx++; setTimeout(step, STAR_STEP_MS);
        })();
      });
    }

    function fireConfetti(duration=2000){
      const end=Date.now()+duration; const pc=MOBILE?4:5;
      (function frame(){ window.confetti && confetti({particleCount:pc, startVelocity:30, spread:360, origin:{x:Math.random(), y:Math.random()-0.2}}); if(Date.now()<end) requestAnimationFrame(frame); })();
    }

    function isLikelyGibberish(text){
      const t=(text||'').trim(); if(t.length<10) return true; if(!/[ê°€-í£A-Za-z]/.test(t)) return true; if(/(.)\1{3,}/.test(t)) return true;
      const badSeq=["ã…‹ã…‹","ã…ã…","ã… ã… ","ã…œã…œ","ã…ã„´ã…‡ã„¹","asdf","qwer","zxcv","dfgh","hjkl"]; const low=t.toLowerCase(); for(const b of badSeq){ if(low.includes(b.repeat(3))) return true; }
      const nonAlnum=(t.match(/[^ê°€-í£A-Za-z0-9]/g)||[]).length; if(nonAlnum/t.length>0.6) return true;
      const uniqKo=new Set((t.match(/[ê°€-í£]/g)||[])); if(uniqKo.size<4) return true; return false;
    }

    function pickRandomCompliment(){
      const ids=["compliment1","compliment2","compliment3","compliment4","compliment5","compliment6"];
      const els=ids.map(id=>document.getElementById(id)).filter(Boolean);
      return els[Math.floor(Math.random()*els.length)];
    }
    async function playRandomComplimentWithRetry(){
      const a=pickRandomCompliment();
      let ok = await playOne(a);
      if(!ok){
        const rs=document.getElementById('resultScreen');
        const handler=async ()=>{ rs.removeEventListener('pointerdown', handler); await playOne(a); };
        rs.addEventListener('pointerdown', handler, {once:true});
      }
    }

    (function setupSubmit(){
      const formScreen=document.getElementById('formScreen'); const resultScreen=document.getElementById('resultScreen');
      const inventorName=document.getElementById('inventorName'); const ideaDisplay=document.getElementById('ideaDisplay');
      const dimoImage=document.getElementById('dimoImage'); const stampArea=document.getElementById('stampArea');

      document.getElementById('ideaForm').addEventListener('submit', async (e)=>{
        e.preventDefault();
        const form=e.currentTarget; if(!form.checkValidity()){ form.reportValidity(); return; }

        const text=(document.getElementById('ideaDetail').value||"").trim();
        if(text.length<10){ alert('ì„¤ëª…ì´ 10ì ë¯¸ë§Œì´ì—ìš”.\nì¡°ê¸ˆë§Œ ë” ìì„¸íˆ ì¨ë³´ì! ğŸ˜‰'); return; }

        const fieldsToCheck=[ {id:'problem',label:'ë¶ˆí¸í–ˆë˜ ìˆœê°„'}, {id:'ideaDetail',label:'ë°œëª…í’ˆ ì„¤ëª…'} ];
        for(const f of fieldsToCheck){
          const v=(document.getElementById(f.id).value||'').trim();
          if(isLikelyGibberish(v)){ alert(`${f.label}ì— ì˜ë¯¸ ìˆëŠ” ë‚´ìš©ì„ ì ì–´ì¤˜!\n(ë°˜ë³µë¬¸ì/í‚¤ë³´ë“œ ë§ˆêµ¬ ì…ë ¥/íŠ¹ìˆ˜ë¬¸ì ë‚¨ë°œì€ ì•ˆë¼ìš”)`); return; }
        }

        await unlockAudios(["compliment1","compliment2","compliment3","compliment4","compliment5","compliment6","audioPerfect","audioRare"]);

        inventorName.textContent=document.getElementById('nickname').value;
        ideaDisplay.textContent=document.getElementById('ideaName').value;

        dimoImage.src=dimoImages[Math.floor(Math.random()*dimoImages.length)];
        dimoImage.style.display='block';

        formScreen.classList.remove('active');
        resultScreen.classList.add('active');
        const cardEl=document.getElementById('celebrationArea');
        cardEl.classList.add('glow');

        const len=text.length;
        let stampSrc=null, didPerfect=false, didRare=false;
        if(len>=30) stampSrc='ë””ëª¨ìŠ¤íƒ¬í”„01.png';
        if(len>=40 && Math.random()<0.04){ didPerfect=true; stampSrc='ë””ëª¨ìŠ¤íƒ¬í”„ë§Œì 02.png'; }
        else if(len>=50 && Math.random()<0.05){ didRare=true; stampSrc='ë””ëª¨ìŠ¤íƒ¬í”„ë ˆì–´03.png'; }

        const scores = didPerfect
          ? {creativity:5, feasibility:5, technical:5}
          : {
              creativity: Math.round((3.5+Math.random()*1.5)*2)/2,
              feasibility: Math.round((3.5+Math.random()*1.5)*2)/2,
              technical: Math.round((3.5+Math.random()*1.5)*2)/2
            };

        ["creativity","feasibility","technical"].forEach(id=>{
          const el=document.getElementById(id); if(el) el.innerHTML='<span class="star">â˜…</span>'.repeat(5);
        });

        await animateStarsToScore('creativity',  scores.creativity);
        await animateStarsToScore('feasibility', scores.feasibility);
        await animateStarsToScore('technical',   scores.technical);

        setTimeout(()=>fireConfetti(2000),700);

        setTimeout(async ()=>{
          if(stampSrc){
            const size=132, offset=24, card=cardEl;
            const posX=card.clientWidth - size - offset, posY=offset;
            stampArea.innerHTML=`
              <div class="stamp-wrap hit" style="left:${posX}px;top:${posY}px;width:${size}px;height:${size}px;">
                <img src="${stampSrc}" alt="ìŠ¤íƒ¬í”„" class="stamp-img stamp-enter" style="--r:${(Math.random()*8-4).toFixed(1)}deg">
                <span class="impact"></span><span class="ink"></span>
              </div>`;
            const bubble=document.createElement('div'); bubble.className='stamp-bubble'; bubble.textContent='ê¾¹-';
            bubble.style.left=(posX+size-12)+'px'; bubble.style.top=(posY-6)+'px'; stampArea.appendChild(bubble); setTimeout(()=>bubble.remove(),900);
            card.classList.add('paper-jolt'); setTimeout(()=>card.classList.remove('paper-jolt'),240);
            if(navigator.vibrate){ try{ navigator.vibrate(30); }catch(_){} }
          }else{
            stampArea.innerHTML="";
          }
          await playRandomComplimentWithRetry();
        }, 2000);
      });
    })();

    (function setupStarTwinkle(){
      document.querySelectorAll('.stars').forEach(el=>{
        el.addEventListener('click', ()=>{ el.classList.add('twinkle'); setTimeout(()=>el.classList.remove('twinkle'),650); }, {passive:true});
      });
    })();

    (function setupActions(){
      const btn=document.getElementById('shareBtn'); const toast=document.getElementById('toast');
      function showToast(){ if(!toast) return; toast.classList.remove('show'); void toast.offsetWidth; toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'),1800); }
      btn.addEventListener('click', ()=>{
        const card=document.getElementById('celebrationArea'); const scale=Math.min(MOBILE?1.2:1.5, window.devicePixelRatio||1);
        html2canvas(card,{ scale, useCORS:true }).then(canvas=>{
          const link=document.createElement('a'); link.href=canvas.toDataURL('image/png'); link.download='dimo_card.png';
          if(/iPad|iPhone|iPod/.test(navigator.userAgent)){ const w=window.open(); if(w&&w.document){ w.document.write('<img src="'+link.href+'" style="width:100%">'); } } else { link.click(); }
          showToast(); sprayParticlesAroundCard(2600);
        }).catch(()=>{ showToast(); sprayParticlesAroundCard(2000); });
      }, {passive:true});
    })();
  </script>

  <!-- ====== ADD-ON íŒ¨ì¹˜: ì‚¬ìš´ë“œ/ëª¨ì…˜ í† ê¸€, í…Œë§ˆ, ì½”ë‚˜ë¯¸, ë„¤ì´í‹°ë¸Œ ê³µìœ , ìŠ¤í‹°ì»¤ ë ˆì¸ ====== -->
  <script>
  (function addEnhancements(){
    const LS = {
      get(k, v){ try{ const x=localStorage.getItem(k); return x===null?v:JSON.parse(x);}catch(_){ return v; } },
      set(k, v){ try{ localStorage.setItem(k, JSON.stringify(v)); }catch(_){} }
    };
    let soundOn = LS.get('dimoSound', true);
    let motionOn = LS.get('dimoMotion', true);
    let theme = LS.get('dimoTheme', 'mint');
    document.body.classList.add('theme-'+theme);
    if(!motionOn) document.body.classList.add('calm');

    const soundToggle = document.getElementById('soundToggle');
    const motionToggle = document.getElementById('motionToggle');
    if(soundToggle){ soundToggle.checked = soundOn; soundToggle.addEventListener('change', ()=>{ soundOn = soundToggle.checked; LS.set('dimoSound', soundOn); showToastMsg(soundOn?'ğŸ”ˆ ì‚¬ìš´ë“œ ON':'ğŸ”‡ ì‚¬ìš´ë“œ OFF'); }); }
    if(motionToggle){ motionToggle.checked = motionOn; motionToggle.addEventListener('change', ()=>{ motionOn = motionToggle.checked; LS.set('dimoMotion', motionOn); document.body.classList.toggle('calm', !motionOn); showToastMsg(motionOn?'ğŸï¸ ëª¨ì…˜ ON':'ğŸŒ™ ì €ìê·¹ ëª¨ë“œ'); }); }

    document.querySelectorAll('.dot[data-theme]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const t = btn.dataset.theme;
        document.body.classList.remove('theme-mint','theme-candy','theme-ocean');
        document.body.classList.add('theme-'+t);
        theme = t; LS.set('dimoTheme', t);
        showToastMsg('ğŸ¨ í…Œë§ˆ: '+(t==='mint'?'ë¯¼íŠ¸':t==='candy'?'ìº”ë””':'ì˜¤ì…˜'));
      }, {passive:true});
    });

    const _playOne = window.playOne;
    window.playOne = function(a){
      if(!soundOn) return Promise.resolve(false);
      return _playOne ? _playOne(a) : Promise.resolve(false);
    };
    const _unlock = window.unlockAudios;
    window.unlockAudios = async (ids)=>{ if(!soundOn) return; return _unlock && _unlock(ids); };
    const _spray = window.sprayParticlesAroundCard;
    window.sprayParticlesAroundCard = function(ms){ if(!motionOn) return; return _spray && _spray(ms); };
    const _conf = window.fireConfetti;
    window.fireConfetti = function(d){ if(!motionOn) return; return _conf && _conf(d); };

    const stickers = ['ğŸ’¡','â­','ğŸ’–','ğŸˆ','ğŸ”§','ğŸ§ª','âœ¨'];
    function stickerRain(duration=1800){
      if(!motionOn) return;
      const start = Date.now();
      const drop = ()=>{
        if(Date.now()-start>duration) return;
        for(let i=0;i<4;i++){
          const e=document.createElement('div'); e.textContent=stickers[Math.floor(Math.random()*stickers.length)];
          e.style.cssText=`position:fixed; left:${Math.random()*100}vw; top:-10vh; font-size:${18+Math.random()*18}px; pointer-events:none; z-index:10001; opacity:0;`;
          document.body.appendChild(e);
          e.animate([{transform:`translateY(-10vh)`, opacity:0},{transform:`translateY(${110+Math.random()*40}vh) rotate(${(Math.random()*90-45)}deg)`, opacity:1}], {duration:1500+Math.random()*800, easing:'cubic-bezier(.2,.7,.2,1)', fill:'forwards'});
          setTimeout(()=>e.remove(), 2600);
        }
        requestAnimationFrame(drop);
      };
      drop();
    }
    document.getElementById('shareBtn')?.addEventListener('click', ()=>stickerRain(), {passive:true});

    document.getElementById('sysShareBtn')?.addEventListener('click', async ()=>{
      try{
        const card=document.getElementById('celebrationArea');
        const scale=Math.min(1.5, window.devicePixelRatio||1);
        const canvas = await html2canvas(card,{scale, useCORS:true});
        const blob = await new Promise(res=>canvas.toBlob(res,'image/png'));
        if(!blob) throw new Error('blob-fail');
        const file = new File([blob], 'dimo_card.png', {type:'image/png'});
        if(navigator.canShare && navigator.canShare({files:[file]})){
          await navigator.share({ files:[file], title:'ë””ëª¨ ì¹´ë“œ', text:'ë‚´ ë°œëª… ì•„ì´ë””ì–´ ì¹´ë“œ âœ¨' });
          showToastMsg('ğŸ“¤ ê³µìœ  ì™„ë£Œ!');
        }else{
          document.getElementById('shareBtn')?.click();
        }
      }catch{
        document.getElementById('shareBtn')?.click();
      }
    }, {passive:true});

    const KONAMI = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
    let seq = [];
    let konamiUntil = 0;
    function konamiActive(){ return Date.now()<konamiUntil; }
    function armKonami(){
      konamiUntil = Date.now()+90_000;
      showToastMsg('ğŸ•¹ï¸ ë ˆì–´ ì°¬ìŠ¤ ON! (90ì´ˆ)');
      fireConfetti(1600);
    }
    window.addEventListener('keydown', (e)=>{
      seq.push(e.key.length===1?e.key.toLowerCase():e.key);
      if(seq.length>KONAMI.length) seq.shift();
      const ok = KONAMI.every((k,i)=>k===seq[i]);
      if(ok){ armKonami(); }
    });

    const stampArea = document.getElementById('stampArea');
    if(stampArea){
      const mo = new MutationObserver(()=>{
        if(!(Date.now()<konamiUntil)) return;
        const img = stampArea.querySelector('.stamp-img');
        if(img && !/ë ˆì–´|rare/i.test(img.src)){
          img.src = 'ë””ëª¨ìŠ¤íƒ¬í”„ë ˆì–´03.png';
          fireConfetti(1200);
        }
      });
      mo.observe(stampArea, {childList:true, subtree:true});
    }

    function showToastMsg(msg){
      const t=document.getElementById('toast'); if(!t) return;
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'), 1600);
    }

    setTimeout(()=>showToastMsg('ğŸ”ˆ/ğŸŒ™/ğŸ¨ ìƒë‹¨ì—ì„œ ë°”ë¡œ ë°”ê¿”ë´!'), 800);
  })();
  </script>

  <!-- ====== SAFE PATCH: ì˜ë¯¸ì—†ëŠ” ê¸€ì íŒì • ì™„í™” (ì›ë³¸ í•¨ìˆ˜ ë³´ì¡´, ë™ëª… ì¬ì •ì˜) ====== -->
  <script>
  (function(){
    const reRepeat4 = /(.)\1{3,}/; // ê°™ì€ ê¸€ì 4íšŒ ì´ìƒ
    // ê¸°ì¡´ window.isLikelyGibberish ë¥¼ "ë®ì–´ì”€" (ì›ë³¸ì€ ìœ„ì— ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆìŒ)
    window.isLikelyGibberish = function(text){
      const t = (text||'').trim();

      // 1) ìµœì†Œ ê¸¸ì´ë§Œ ìœ ì§€
      if (t.length < 10) return true;

      // 2) ê¸€ì(í•œê¸€/ì˜ë¬¸) í•˜ë‚˜ë„ ì—†ìœ¼ë©´ ê±°ì ˆ
      const letters = t.match(/[A-Za-zê°€-í£]/g) || [];
      if (!letters.length) return true;

      // 3) íŠ¹ìˆ˜ë¬¸ì ë¹„ìœ¨ (ê³µë°± ì œì™¸, 50% ì´ˆê³¼ ì‹œ ê±°ì ˆ) â€” ê¸°ì¡´ë³´ë‹¤ ì™„í™”
      const nonWord = (t.match(/[^A-Za-z0-9ê°€-í£\s]/g) || []).length;
      if (nonWord / t.length > 0.5) return true;

      // 4) ê³¼ë„í•œ ë°˜ë³µ ì°¨ë‹¨ (ã…‹ã…‹ã…‹ã…‹, aaaa ë“± 4íšŒ ì´ìƒ)
      if (reRepeat4.test(t)) return true;

      // 5) í‚¤ë³´ë“œ ëŸ°(asdf/qwer ë“±) 2íšŒ ì´ìƒ ë°˜ë³µ ì‹œ ì°¨ë‹¨
      const low = t.toLowerCase();
      if (/(asdf|qwer|zxcv|dfgh|hjkl){2,}/.test(low)) return true;

      // âœ… ì–¸ì–´ ì¤‘ë¦½: ì„œë¡œ ë‹¤ë¥¸ 'ë¬¸ì ì¢…ë¥˜' 4ê°œ ì´ìƒì´ë©´ í†µê³¼ (í•œê¸€ ì „ìš© ê¸°ì¤€ ì œê±°)
      const uniqLetters = new Set(letters.map(c => c.toLowerCase()));
      if (uniqLetters.size < 4) return true;

      return false; // í†µê³¼
    };
  })();
  </script>
</body>
</html>
