
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë””ëª¨ì™€ í•¨ê»˜ í•˜ëŠ” ìƒìƒ ë†€ì´í„°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- í°íŠ¸ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

  <style>
    :root{
      --main:#5cab6d; --accent:#a5e6b8; --bg:#f8fff9; --text:#173322;
      --shadow:0 12px 40px rgba(0,0,0,.16);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:'Jua',sans-serif;background:var(--bg);color:var(--text)}
    .screen{display:none}.screen.active{display:block}

    /* ë²„íŠ¼ */
    .btn{
      border:none;border-radius:28px;padding:14px 28px;font-size:18px;font-weight:800;
      cursor:pointer;white-space:nowrap;min-width:220px;position:relative;z-index:10;
    }
    .btn-primary{background:linear-gradient(90deg,#7bd49a,#4aa06b);color:#fff;box-shadow:0 8px 18px rgba(0,0,0,.12)}
    .btn-primary:hover{filter:brightness(1.05);transform:translateY(-1px)}
    .btn:active{animation:jelly .6s}
    @keyframes jelly{0%{transform:scale(1)}30%{transform:scale(.95,1.05)}60%{transform:scale(1.05,.95)}100%{transform:scale(1)}}

    /* ì¸íŠ¸ë¡œ ë ˆì´ì•„ì›ƒ */
    #intro .intro{ min-height:100svh; }
    @supports (min-height: 100dvh){ #intro .intro{ min-height:100dvh; } }
    .intro{
      display:flex;flex-direction:column;align-items:center;justify-content:flex-start;
      gap:10px;padding:20px;text-align:center;background:linear-gradient(180deg,#f8fff9 0%, #e9fdee 100%);
      position:relative;padding-top:clamp(24px,8vh,72px);
    }
    .intro-top{margin:0;color:#2c7a4c;font-size:clamp(28px, 6vw, 34px)}
    .intro-top.wave span{ display:inline-block; transform:translateZ(0); animation:waveChar 1.6s ease-in-out infinite; }
    @keyframes waveChar{ 0%,100%{transform:translate3d(0,0,0)} 50%{transform:translate3d(0,-10px,0)} }
    .intro-main{
      margin:0;font-size:clamp(40px, 12vw, 54px);line-height:1.1;
      background:linear-gradient(90deg,#A5E6B8,#A9D6FF,#FFD6E8,#FFEAA7,#A5E6B8);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-size:300% 100%;
      animation:shine 6s linear infinite; text-shadow:0 4px 10px rgba(0,0,0,.08);
    }
    @keyframes shine{0%{background-position:0%}100%{background-position:100%}}
    video{
      width:min(780px,94vw); max-width:100%;
      aspect-ratio:16/9; object-fit:cover; background:#f4f4f4;
      border-radius:18px; box-shadow:var(--shadow);
      max-height:48vh;
    }

    /* í•˜ë‹¨ ë¡œê³ (ê³µí†µ ì´ë¯¸ì§€ ë˜í¼) */
    .footer-logo{
      position:absolute; left:50%; transform:translateX(-50%);
      bottom:calc(env(safe-area-inset-bottom) + 14px);
      width:min(80vw, 600px);
      height:clamp(70px, 12vh, 140px);
      color:transparent !important; text-indent:-9999px; white-space:nowrap; overflow:hidden;
      background:none !important;
    }
    #intro .footer-logo{ bottom: calc(env(safe-area-inset-bottom) + 28px) !important; }
    .footer-logo .footer-logo-img{
      display:block; width:100%; height:100%;
      object-fit:contain; object-position:center; pointer-events:none;
    }

    /* í¼ */
    .wrap{max-width:740px;margin:0 auto;padding:16px}
    form{background:#fff;border:3px solid var(--accent);border-radius:20px;padding:22px;box-shadow:0 8px 20px rgba(0,0,0,.08)}
    .form-group{margin-bottom:18px}
    label{display:block;margin-bottom:8px;color:#1e3e2d;font-weight:900}
    input,select,textarea{
      width:100%;font-family:'Jua',sans-serif;font-size:18px;border:2px solid #d3f2db;border-radius:12px;padding:14px;background:#fff;
      transition:border .15s, box-shadow .15s
    }
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--main);box-shadow:0 0 0 3px rgba(92,171,109,.18)}
    textarea{min-height:120px;resize:vertical}

    /* ì¹©/ìŠ¤í‹°ì»¤ */
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin:8px 0 2px; }
    .chip{
      border:none; border-radius:999px; padding:10px 14px; font-size:16px; font-weight:900;
      background:#eef6ef; color:#17402a; box-shadow:inset 0 0 0 2px #d3f2db;
      min-height:44px; cursor:pointer;
    }
    .chip:active{ transform:scale(.98); }
    .mini-stickers{
      display:flex; align-items:center; gap:8px; margin:0 0 12px;
      position:sticky; top:0; z-index:5; background:linear-gradient(180deg,#ffffff, #ffffffcc 70%, transparent);
      padding-bottom:6px;
    }
    .mini-sticker{
      width:32px; height:32px; border-radius:50%;
      display:grid; place-items:center; font-size:18px; filter:grayscale(1) opacity(.5);
      border:2px solid #d3f2db; background:#f6fff8;
    }
    .mini-sticker.done{ filter:none; opacity:1; border-color:#7bd49a; background:#eafff1; box-shadow:0 3px 10px rgba(0,0,0,.08); }
    .mini-sticker .label{ position:absolute; left:-9999px; }

    /* ê²Œì´ì§€ */
    .gauge-row{display:flex;align-items:center;gap:10px;margin-top:6px}
    .gauge{flex:1;background:#eef6ef;border-radius:12px;height:18px;overflow:hidden;position:relative;box-shadow:inset 0 2px 4px rgba(0,0,0,.06)}
    .gauge-bar{height:100%;width:0%;background:#ffcc00;transition:width .35s ease, background .35s ease}
    .gcount{min-width:48px;text-align:right;font-weight:900;color:#2d4d38;opacity:.9}
    .gmsg{margin-top:8px;font-size:16px;color:#2d4d38;min-height:1.6em}

    /* ê²°ê³¼ ì¹´ë“œ */
    .card{
      position:relative;background:#fff;border:3px solid var(--accent);border-radius:20px;
      padding:10px 10px 16px; max-width:740px;margin:0 auto;box-shadow:0 10px 22px rgba(0,0,0,.12);overflow:hidden;
      /* ë¡œê³ (ì¤‘ì•™) & ë‚ ì§œ(ìš°í•˜ë‹¨) ê³µê°„ í™•ë³´ */
      padding-bottom:110px;
    }
    .banner{ margin:4px 0 6px;text-align:center;color:#2d4d38;font-size:24px; position:relative; }
    .banner::before{content:"ğŸ‰ "; margin-right:4px;}
    .banner::after{content:" ğŸ‰"; margin-left:4px;}
    .card-body{display:grid;grid-template-columns:minmax(98px,120px) 1fr;gap:10px;align-items:center}
    .dimo{width:112px;border-radius:16px;display:none}
    .ratings{display:grid;gap:8px}
    .rating{display:flex;flex-direction:column;gap:6px;background:#f9fffb;border:2px solid #d3f2db;border-radius:10px;padding:6px 10px}
    .rating h3{margin:0;font-size:16px;color:#2d4d38}

    /* ì¹­ì°¬ ë°•ìŠ¤ */
    .cbox{
      background:#edf9f1; border:2px solid #cdeed8;border-radius:12px;padding:10px 12px;margin:0 0 2px 0;
      font-size:clamp(18px, 4.2vw, 20px);font-weight:900;color:#14543a;display:flex;align-items:center;gap:8px;
      word-break:keep-all; line-height:1.28;
      border-radius:12px; border:3px solid transparent;
      background:
        linear-gradient(#edf9f1,#edf9f1) padding-box,
        conic-gradient(#ff6b6b,#ffd166,#a0e062,#4f92ff,#a48bff,#ff7f7f,#ff6b6b) border-box;
      background-clip:padding-box,border-box;
    }

    /* ë³„ì  */
    .stars{display:flex;gap:6px;white-space:nowrap;font-size:24px}
    .star{position:relative;color:#d8d8d8}
    .star.full{color:#F5B301}
    .star.half::before{content:"â˜…";position:absolute;left:0;top:0;width:50%;overflow:hidden;color:#F5B301}

    /* ë°œëª…ì/ë°œëª…í’ˆ */
    .info{
      margin-top:10px;padding:10px 12px;border-radius:12px;border:2px solid #d3f2db;background:#fafffa;
      text-align:center;font-size:16px;display:flex;flex-direction:column;gap:6px;align-items:center
    }
    .info strong{color:var(--main)}

    /* ìŠ¤íƒ¬í”„ (ë””ëª¨ ìš°í•˜ë‹¨ ê³ ì •) */
    #stampArea{position:absolute;inset:0;pointer-events:none}
    .stamp-wrap{position:absolute; transform-origin:100% 100%; transform:scale(1.08);}
    .stamp-img{width:100%;display:block;filter:drop-shadow(0 6px 12px rgba(0,0,0,.12));transform-origin:center;opacity:.97}
    .stamp-enter{animation:pop .52s cubic-bezier(.18,1.4,.22,1) forwards, stamp-shiver .22s ease-out .52s 1}
    @keyframes pop{0%{opacity:0;transform:translateY(-14px) scale(1.2) rotate(var(--r,-4deg))}65%{opacity:1;transform:translateY(0) scale(.96) rotate(var(--r,-4deg))}100%{transform:scale(1) rotate(var(--r,-4deg))}}
    @keyframes stamp-shiver{0%{transform:translate(0,0) rotate(var(--r,-4deg))}40%{transform:translate(-.6px,.4px) rotate(calc(var(--r,-4deg) + .4deg))}70%{transform:translate(.4px,-.6px) rotate(calc(var(--r,-4deg) - .3deg))}100%{transform:translate(0,0) rotate(var(--r,-4deg))}}

    /* ê²°ê³¼ ì¹´ë“œ í•˜ë‹¨: ë¡œê³  ì¤‘ì•™, ë‚ ì§œ ìš°í•˜ë‹¨ */
    #resultScreen .footer-logo{
      position:absolute; left:50%; transform:translateX(-50%);
      bottom:12px; width:min(62vw,360px); height:clamp(48px,9vh,88px); pointer-events:none;
    }
    #cardDate{
      position:absolute; right:12px; bottom:16px;
      font-size:14px; color:#1b3b2a; opacity:.9;
    }

    /* ê²°ê³¼ í™”ë©´ ì»´íŒ©íŠ¸í™” (ëª¨ë°”ì¼) */
    #resultScreen .card-body{ grid-template-columns: 1fr; align-items:start; gap:8px; }
    #resultScreen .dimo{ display:block; margin: 6px auto 10px; transform:scale(1.1); }
    #resultScreen .rating{ flex-direction:row; align-items:center; justify-content:space-between; gap:10px; padding:4px 8px; }
    #resultScreen .stars{ font-size:22px; }

    /* ë””ëª¨ ì´ë¯¸ì§€ ê¸°ì¤€ ë˜í¼ (ìŠ¤íƒ¬í”„ ê³ ì • ê¸°ì¤€) */
    #resultScreen .dimo-wrap{ position:relative; display:inline-block; }

    /* ì €ì¥/í† ìŠ¤íŠ¸ */
    .center{text-align:center;margin-top:10px}
    .btn-save{background:linear-gradient(135deg,#bff3c8,#8de0d3);color:#0f3a30;font-weight:900;min-width:260px;padding:12px 20px}
    .toast{
      position:fixed;left:50%;transform:translateX(-50%);
      bottom:calc(20px + env(safe-area-inset-bottom));
      background:#2c7a4c;color:#fff;padding:12px 16px;border-radius:10px;
      font-weight:800;box-shadow:0 10px 20px rgba(0,0,0,.18);opacity:0;visibility:hidden;transition:.25s;z-index:9999
    }
    .toast.show{opacity:1;visibility:visible}

    /* ìŠ¤íŒŒí´(ì¸íŠ¸ë¡œ íƒ­) */
    .spark{
      position:fixed; left:0; top:0;
      transform:translate(-50%,-50%) scale(.9);
      font-size:12px; line-height:1;
      user-select:none; pointer-events:none;
      will-change: transform, opacity;
      z-index:3500;
      animation: spark-fly 720ms cubic-bezier(.2,.8,.2,1) forwards;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
    }
    @keyframes spark-fly{
      0%   { opacity:1;  transform:translate(-50%,-50%) scale(.9); }
      100% { opacity:0;  transform:translate(calc(-50% + var(--tx,0px)), calc(-50% + var(--ty,0px))) scale(1.2); }
    }

    /* ---------------------------
       â¬‡â¬‡â¬‡  SAFE PATCH ì¶”ê°€ â¬‡â¬‡â¬‡
       --------------------------- */

    /* === SAFE PATCH: LOGO SCALE + SAFE-AREA === */

    /* ê¸°ë³¸ ìœ„ì¹˜ ìœ ì§€ + ìŠ¤ì¼€ì¼ë¡œë§Œ í™•ëŒ€ */
    #intro .footer-logo,
    #resultScreen .footer-logo{
      transform: scale(var(--logo-scale, 1));
      transform-origin: center bottom;
      /* ì„¸ì´í”„ì—ì–´ë¦¬ì–´ ê³ ë ¤í•œ í•˜ë‹¨ ê³ ì • */
      bottom: max(12px, calc(env(safe-area-inset-bottom) + 12px)) !important;
    }

    /* ë°ìŠ¤í¬íƒ‘ì—ì„œë§Œ í¬ê²Œ (í•„ìš” ì‹œ ìˆ˜ì¹˜ ì¡°ì ˆ) */
    @media (min-width: 1200px){
      :root{ --logo-scale: 1.6; }   /* ì¸íŠ¸ë¡œ/ê²°ê³¼ ê³µí†µ í™•ëŒ€ */
    }
    @media (min-width: 1600px){
      :root{ --logo-scale: 1.9; }
    }

    /* ê²°ê³¼ ì¹´ë“œ ì•ˆìª½ì€ ì¶”ê°€ ê³µê°„ í™•ë³´(ë¡œê³  í™•ëŒ€ ëŒ€ë¹„) */
    #card{
      padding-bottom: 140px; /* ê¸°ë³¸ 110px â†’ ì—¬ìœ  ì¦ê°€ */
    }
    @media (min-width: 1200px){
      #card{ padding-bottom: 180px; }
    }
    @media (min-width: 1600px){
      #card{ padding-bottom: 210px; }
    }

    /* (ì„ íƒ) ëª¨ë°”ì¼ì—ì„œ ì‚´ì§ ë” ë„ìš°ê³  ì‹¶ë‹¤ë©´ */
    @media (max-width: 600px){
      #intro .footer-logo,
      #resultScreen .footer-logo{
        bottom: max(20px, calc(env(safe-area-inset-bottom) + 16px)) !important;
      }
    }
    /* ---------------------------
       â¬†â¬†â¬†  SAFE PATCH ë â¬†â¬†â¬†
       --------------------------- */
  </style>
</head>
<body>
  <!-- ì¸íŠ¸ë¡œ -->
  <section id="intro" class="screen active">
    <div class="intro">
      <h2 class="intro-top">ë””ëª¨ì™€ í•¨ê»˜ í•˜ëŠ”</h2>
      <h1 class="intro-main">ìƒìƒ ë†€ì´í„°</h1>

      <video autoplay muted loop playsinline webkit-playsinline poster="dimo_poster.jpg">
        <source src="dimo.mp4" type="video/mp4">
      </video>

      <button id="toForm" class="btn btn-primary">ğŸ‘‹ ë””ëª¨ ë§Œë‚˜ëŸ¬ ê°€ê¸°</button>

      <!-- ì¸íŠ¸ë¡œ í•˜ë‹¨ ë¡œê³  -->
      <div class="footer-logo intro-footer">
        <img class="footer-logo-img" alt="ë””ëª¨ìœ ë‹ˆë²„ìŠ¤">
      </div>

      <!-- ì¸ì‚¬ ìŒì„± (ëœë¤ | preload none) -->
      <audio id="intro1" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬1.mp3" preload="none"></audio>
      <audio id="intro2" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬2.mp3" preload="none"></audio>
      <audio id="intro3" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬3.mp3" preload="none"></audio>
      <audio id="intro4" src="ë””ëª¨ì¸íŠ¸ë¡œì¸ì‚¬4.mp3" preload="none"></audio>
    </div>
  </section>

  <!-- ì„¤ë¬¸ -->
  <section id="formScreen" class="screen">
    <div class="wrap">
      <div id="miniStickers" class="mini-stickers" role="status" aria-live="polite"></div>

      <form id="ideaForm" novalidate autocomplete="on">
        <div class="form-group">
          <label for="age">1. ë””ëª¨ëŠ” ì¹œêµ¬ ë‚˜ì´ê°€ ê¶ê¸ˆí•´! *</label>
          <select id="age" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="8">8ì„¸</option><option value="9">9ì„¸</option><option value="10">10ì„¸</option>
            <option value="11">11ì„¸</option><option value="12">12ì„¸</option><option value="13">13ì„¸</option>
            <option value="14">14ì„¸</option><option value="15">15ì„¸</option><option value="16">16ì„¸</option>
            <option value="17">17ì„¸</option><option value="18">18ì„¸</option><option value="19">19ì„¸</option>
          </select>
        </div>

        <div class="form-group">
          <label for="nickname">2. ë„ˆì˜ ë©‹ì§„ ë³„ëª…ì„ ì •í•´ì¤˜! *</label>
          <input id="nickname" name="nickname" type="text" placeholder="ì˜ˆ: ë°œëª…ì™•"
                 inputmode="text" autocomplete="nickname" autocapitalize="words" spellcheck="false" required>
          <div id="chips-nickname" class="chips"></div>
        </div>

        <div class="form-group">
          <label for="problem">3. 'ì•„~ ì´ê±° ë¶ˆí¸í•˜ë‹¤!' í–ˆë˜ ìˆœê°„ì€? *</label>
          <textarea id="problem" placeholder="ì˜ˆ: ì—°í•„ì´ ìê¾¸ êµ´ëŸ¬ê°€ì„œ ìƒì–´ë²„ë ¤ìš”"
                    inputmode="text" autocapitalize="sentences" spellcheck="true" required></textarea>
          <div id="chips-problem" class="chips"></div>
        </div>

        <div class="form-group">
          <label for="ideaName">4. ê·¸ ë¶ˆí¸ì„ í•´ê²°í•  ë©‹ì§„ ë°œëª…í’ˆ ì´ë¦„ì€? *</label>
          <input id="ideaName" type="text" placeholder="ì˜ˆ: ì•ˆ êµ´ëŸ¬ê°€ëŠ” ì—°í•„"
                 inputmode="text" autocapitalize="words" autocomplete="on" spellcheck="false" required>
          <div id="chips-ideaname" class="chips"></div>
        </div>

        <div class="form-group">
          <label for="ideaDetail">5. ë°œëª…í’ˆì€ ì–´ë–»ê²Œ ì‘ë™í•˜ê³  ë­ê°€ í¸í•´ì ¸? *</label>
          <textarea id="ideaDetail" placeholder="ì˜ˆ: ì—°í•„ì— ì‘ì€ ìì„ì´ ë¶™ì–´ì„œ ì±…ìƒì— ë”± ë¶™ì–´ìš”â€¦"
                    inputmode="text" autocapitalize="sentences" spellcheck="true" required></textarea>

          <div class="gauge-row">
            <div class="gauge" aria-hidden="true">
              <div class="gauge-bar" id="charBar"></div>
            </div>
            <div id="charCount" class="gcount" aria-live="polite">0ì</div>
          </div>
          <div id="charMsg" class="gmsg">ğŸŒ± ì•„ì§ ìƒê°ì˜ ì”¨ì•— ë‹¨ê³„ì˜ˆìš”.</div>

          <div id="chips-ideadetail" class="chips"></div>
        </div>

        <!-- ì´ë©”ì¼ ì•ˆë‚´ ë° ì„ íƒ ì…ë ¥ (ê°œì¸ì •ë³´ ë™ì˜ ìœ ì§€) -->
        <div class="form-group">
          <label>6. (ì„ íƒ) ë³´í˜¸ì ì´ë©”ì¼</label>
          <div style="font-size:14px;color:#2d4d38;opacity:.9;margin:6px 0 10px">
            â€» <b>êµ¿ì¦ˆ ì´ë²¤íŠ¸ ì‘ëª¨ë¥¼ ì›í•  ê²½ìš°ì—ë§Œ</b> ì´ë©”ì¼ì„ ì…ë ¥í•´ìš”. <b>ì…ë ¥í•˜ì§€ ì•Šì•„ë„ ìŠ¤íƒ¬í”„ëŠ” ê·¸ëŒ€ë¡œ ì§„í–‰</b>ë¼ìš”.
          </div>

          <label class="consent-row" style="display:flex;align-items:center;gap:10px;margin-bottom:8px">
            <input id="emailConsent" type="checkbox" aria-controls="emailBlock" aria-expanded="false" style="width:20px;height:20px;accent-color:var(--main)">
            <span>êµ¿ì¦ˆ ì´ë²¤íŠ¸ ì‘ëª¨ (ì„ íƒ)</span>
          </label>

          <div id="emailBlock" style="display:none;margin-left:2px">
            <input id="parentEmail" type="email" placeholder="ì˜ˆ: parent@example.com"
                   inputmode="email" autocapitalize="off" autocorrect="off" spellcheck="false" style="margin-top:4px">
            <div class="consent-note" style="font-size:14px;color:#2d4d38;opacity:.8;margin-top:6px">
              â€» ì´ë©”ì¼ì€ <b>ê²½í’ˆ(êµ¿ì¦ˆ) ë‹¹ì²¨ ì•ˆë‚´</b> ìš©ë„ë¡œë§Œ ì‚¬ìš©ë˜ë©°, í–‰ì‚¬ ì¢…ë£Œ í›„ ì¦‰ì‹œ íŒŒê¸°ë©ë‹ˆë‹¤.
            </div>
          </div>
        </div>

        <div class="center"><button type="submit" class="btn btn-primary">ì œì¶œí•˜ê¸°</button></div>
      </form>
    </div>
  </section>

  <!-- ê²°ê³¼ -->
  <section id="resultScreen" class="screen">
    <div class="wrap">
      <div id="card" class="card">
        <h2 class="banner">ë‚˜ë§Œì˜ ì•„ì´ë””ì–´ ì¹´ë“œ</h2>

        <div class="card-body">
          <!-- ë””ëª¨ ì´ë¯¸ì§€ + ìŠ¤íƒ¬í”„ ê¸°ì¤€ -->
          <div class="dimo-wrap">
            <img id="dimoImg" class="dimo" alt="ë””ëª¨" src="">
          </div>
          <div>
            <div id="complimentText" class="cbox">ğŸ’¬ ë””ëª¨ê°€ ì‘ì› ì¤‘!</div>
            <div class="ratings">
              <div class="rating"><h3>ë°˜ì§ì´ëŠ” ìƒìƒë ¥</h3><div id="creativity" class="stars"></div></div>
              <div class="rating"><h3>ì •ë§ ë ê¹Œ? ì ìˆ˜</h3><div id="feasibility" class="stars"></div></div>
              <div class="rating"><h3>ë””ëª¨ì˜ ê¸°ìˆ ë ¥ ë ˆë²¨</h3><div id="technical" class="stars"></div></div>
            </div>
          </div>
        </div>

        <div class="info">
          <span>ğŸ‘¤ <strong>ë°œëª…ì:</strong> <span id="inventorName"></span></span>
          <span>ğŸ’¡ <strong>ë‚´ ë°œëª…í’ˆ:</strong> <span id="ideaDisplay"></span></span>
        </div>

        <!-- ê³¼ê±° ëœë¤ ì˜ì—­(í˜¸í™˜) -->
        <div id="stampArea"></div>

        <!-- ì¹´ë“œ í•˜ë‹¨ ì¤‘ì•™ ë¡œê³  -->
        <div class="footer-logo">
          <img class="footer-logo-img" alt="ë””ëª¨ìœ ë‹ˆë²„ìŠ¤">
        </div>

        <!-- ì¹´ë“œ ë‚´ë¶€ ìš°í•˜ë‹¨ ë‚ ì§œ -->
        <div id="cardDate"></div>

        <!-- ê²°ê³¼ ì¹­ì°¬ ì˜¤ë””ì˜¤ -->
        <audio id="compliment1" src="ë””ëª¨ì¹­ì°¬01.mp3" preload="none"></audio>
        <audio id="compliment2" src="ë””ëª¨ì¹­ì°¬02.mp3" preload="none"></audio>
        <audio id="compliment3" src="ë””ëª¨ì¹­ì°¬03.mp3" preload="none"></audio>
        <audio id="compliment4" src="ë””ëª¨ì¹­ì°¬04.mp3" preload="none"></audio>
        <audio id="compliment5" src="ë””ëª¨ì¹­ì°¬05.mp3" preload="none"></audio>
        <audio id="compliment6" src="ë””ëª¨ì¹­ì°¬ë©”ì‹œì§€.mp3" preload="none"></audio>
      </div>

      <div class="center"><button id="saveBtn" class="btn btn-save">ğŸ¨ ì¹´ë“œ ì €ì¥í•˜ê¸°</button></div>
    </div>
  </section>

  <div id="toast" class="toast" role="status" aria-live="polite">ğŸ“¥ ì•¨ë²”ì— ì €ì¥ë˜ì—ˆì–´ìš”!</div>
  <div id="fxLayer" aria-hidden="true"></div>

  <script>
    /* ===== ì„¤ì • ===== */
    const MOBILE = matchMedia('(max-width: 480px), (pointer: coarse)').matches;
    const dimoImages = ["dimo01.png","dimo02.png","dimo03.png","dimo04.png"];
    const STAR_STEP_MS = 260;
    const STAMP_VIS_RATIO = 0.55; // ë””ëª¨ ì´ë¯¸ì§€ ì˜ì—­ ëŒ€ë¹„ ìŠ¤íƒ¬í”„ ë³´ì´ëŠ” í¬ê¸°

    /* ===== ë¶€íŠ¸ ===== */
    document.addEventListener('DOMContentLoaded', function () {
      updateScreenFlag();
      initLogoFallback();   // ë¡œê³  íŒŒì¼ í´ë°±
      initIntroFlow();      // ì¸íŠ¸ë¡œ â†’ í¼ (ìŒì„± í¬í•¨)
      initOnceCTA();        // CTA 1íšŒë§Œ
      initWaveTitle();      // íƒ€ì´í‹€ ë¬¼ê²°
      initChips();          // ì¹© ìë™ì…ë ¥
      initMiniStickers();   // ë¯¸ë‹ˆ ìŠ¤í‹°ì»¤
      initHints();          // íŒíŠ¸ ìŒì„±
      fitIntroVideo();      // ì¸íŠ¸ë¡œ ë¹„ë””ì˜¤ ë†’ì´
      initGauge();          // ê¸€ììˆ˜ ê²Œì´ì§€
      initEmailToggle();    // ê°œì¸ì •ë³´ ë™ì˜ ì˜ì—­
      bindFormSubmit();     // ì œì¶œ ì²˜ë¦¬(ìŠ¤íƒ¬í”„/ì ìˆ˜/ë‚ ì§œ/ì˜¤ë””ì˜¤)
      initSaver();          // ì¹´ë“œ ì €ì¥
      enableIntroSpark();   // ìŠ¤íŒŒí´
    });

    /* ===== ìœ í‹¸ ===== */
    function ensureScript(src){
      return new Promise(function(resolve, reject){
        if (document.querySelector('script[src="'+src+'"]')) return resolve();
        var s=document.createElement('script'); s.src=src; s.async=true;
        s.onload=resolve; s.onerror=reject; document.head.appendChild(s);
      });
    }
    var AC=null;
    async function resumeAudio(){
      try{
        var C = window.AudioContext || window.webkitAudioContext;
        if(!AC && C) AC = new C();
        if(AC && AC.state === 'suspended') await AC.resume();
      }catch(e){}
    }
    async function playOne(a){
      if(!a) return false;
      try{
        await resumeAudio();
        if(a.preload === 'none') a.load();
        a.currentTime=0; a.muted=false; a.volume=Math.min(a.volume||1,1);
        await a.play();
        return true;
      }catch(e){ return false; }
    }
    async function fireConfetti(duration=1500){
      if(!window.confetti){
        try{
          await ensureScript('https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js');
        }catch(e){ return; }
      }
      var end = Date.now() + duration;
      (function frame(){
        window.confetti && confetti({particleCount: 6, startVelocity: 32, spread: 360, origin:{x:Math.random(), y:Math.random()*0.4}});
        if(Date.now() < end) requestAnimationFrame(frame);
      })();
    }
    function pickRandomComplimentAudio(){
      var ids=["compliment1","compliment2","compliment3","compliment4","compliment5","compliment6"];
      var els=ids.map(function(id){return document.getElementById(id)}).filter(Boolean);
      return els[Math.floor(Math.random()*els.length)];
    }
    async function playComplimentWithFallback(){
      var a = pickRandomComplimentAudio(); if(!a) return;
      var ok = await playOne(a);
      if(!ok){
        var rs=document.getElementById('resultScreen');
        var handler = async function(){ rs.removeEventListener('pointerdown', handler); await playOne(a); };
        rs.addEventListener('pointerdown', handler, {once:true});
      }
    }

    /* ===== ë¡œê³  í´ë°± ===== */
    function initLogoFallback(){
      var candidates = ['logo_dimo.png', 'logo_dimo.webp', 'logo_dimo.jpg', 'ë””ëª¨ìœ ë‹ˆë²„ìŠ¤ë¡œê³ .png'];
      document.querySelectorAll('.footer-logo-img').forEach(function(img){
        var i = 0;
        var tryNext = function(){
          if (i >= candidates.length){
            var box = img.closest('.footer-logo'); if (box) box.style.display='none';
            return;
          }
          img.src = candidates[i++];
        };
        img.addEventListener('error', tryNext);
        tryNext();
      });
    }

    /* ===== ì¸íŠ¸ë¡œ â†’ í¼ ===== */
    function initIntroFlow(){
      var btn=document.getElementById('toForm');
      var intro=document.getElementById('intro');
      var form=document.getElementById('formScreen');
      var intros=["intro1","intro2","intro3","intro4"].map(function(id){return document.getElementById(id)}).filter(Boolean);

      btn.addEventListener('click', async function(){
        await resumeAudio();
        var audio = intros.length ? intros[Math.floor(Math.random()*intros.length)] : null;

        var go=function(){
          intro.classList.remove('active');
          form.classList.add('active');
          updateScreenFlag();
        };

        if(audio){
          var started = await playOne(audio);
          if(started){ audio.onended = function(){ setTimeout(go, 1200); }; }
          else{ setTimeout(go, 1200); }
        }else{
          setTimeout(go, 1200);
        }
      }, {passive:true});
    }

    function initOnceCTA(){
      var btn = document.getElementById('toForm');
      var used = false;
      btn.addEventListener('click', function(e){
        if(used){ e.stopImmediatePropagation(); e.preventDefault(); return; }
        used = true; btn.disabled = true; btn.style.pointerEvents='none';
      }, true);
    }

    /* íƒ€ì´í‹€ ë¬¼ê²° */
    function initWaveTitle(){
      var t = document.querySelector('.intro .intro-top'); if(!t) return;
      var raw = t.textContent; t.textContent = ''; t.classList.add('wave');
      var split = function(str){
        if (window.Intl && typeof Intl.Segmenter === 'function') {
          var seg = new Intl.Segmenter('ko', { granularity: 'grapheme' });
          var out=[]; for (const s of seg.segment(str)) out.push(s.segment); return out;
        }
        return Array.from(str);
      };
      split(raw).forEach(function(ch,i){
        var s=document.createElement('span');
        s.textContent=(ch===' ') ? '\u00A0' : ch;
        s.style.animationDelay = (i*0.08)+'s';
        t.appendChild(s);
      });
    }

    /* ì¹© */
    function initChips(){
      var MAP = [
        { el:'#chips-nickname',  target:'#nickname',
          items:['ë°œëª…ì™•','ë²ˆì©ì²œì¬','ì•„ì´ë””ì–´ì™•','ë””ëª¨ì¹œêµ¬','ë¬¸ì œí•´ê²°ì‚¬'] },
        { el:'#chips-problem',   target:'#problem',
          items:['ì—°í•„ì´ ìê¾¸ êµ´ëŸ¬ê°€ìš”','ê°€ë°©ì´ ë¬´ê±°ì›Œìš”','ì§€ìš°ê°œê°€ ìì£¼ ì‚¬ë¼ì ¸ìš”','ì±…ìƒì´ ì§€ì €ë¶„í•´ìš”','ì²´ìœ¡ë³µì„ ìì£¼ ìŠì–´ìš”'] },
        { el:'#chips-ideaname',  target:'#ideaName',
          items:['ì•ˆ êµ´ëŸ¬ê°€ëŠ” ì—°í•„','ì´ˆê²½ëŸ‰ ê°€ë°©','ì•ˆ ì‚¬ë¼ì§€ëŠ” ì§€ìš°ê°œ','ì •ë¦¬ì™• ì±…ìƒ','ìŠì§€ë§ˆ ì²´ìœ¡ë³µ í´ë¦½'] },
        { el:'#chips-ideadetail',target:'#ideaDetail',
          items:['ì‘ì€ ìì„ìœ¼ë¡œ ë”± ë¶™ì–´ìš”','ì´ˆê²½ëŸ‰ ì†Œì¬ë¡œ ê°€ë²¼ì›Œìš”','ìŠ¤íŠ¸ë©ìœ¼ë¡œ í•­ìƒ ê³ ì •ë¼ìš”','ì¹¸ì´ ë‚˜ë‰˜ì–´ ì •ë¦¬ ì‰¬ì›Œìš”','ì•± ì•Œë¦¼ìœ¼ë¡œ ìŠì§€ ì•Šì•„ìš”'] },
      ];
      var setOrAppend = function(input, text){
        if(!input) return;
        var isEmpty = !input.value || !input.value.trim();
        if(input.tagName==='TEXTAREA'){
          if(isEmpty) input.value = text;
          else input.value = input.value.replace(/\s*$/, '') + (input.value.endsWith('\n')?'':' ') + text;
        }else{
          input.value = isEmpty ? text : (input.value + ' ' + text);
        }
        input.dispatchEvent(new Event('input', {bubbles:true}));
        input.focus();
      };
      MAP.forEach(function(cfg){
        var box = document.querySelector(cfg.el);
        var tgt = document.querySelector(cfg.target);
        if(!box || !tgt) return;
        cfg.items.forEach(function(label){
          var b=document.createElement('button');
          b.type='button'; b.className='chip'; b.textContent=label;
          b.addEventListener('click', function(){ setOrAppend(tgt, label); });
          box.appendChild(b);
        });
      });
    }

    /* ë¯¸ë‹ˆ ìŠ¤í‹°ì»¤ */
    function initMiniStickers(){
      var holder = document.getElementById('miniStickers');
      if(!holder) return;
      var steps = [
        { id:'age',        icon:'ğŸ‚', label:'ë‚˜ì´' },
        { id:'nickname',   icon:'ğŸ·', label:'ë³„ëª…' },
        { id:'problem',    icon:'ğŸ§©', label:'ë¬¸ì œ' },
        { id:'ideaName',   icon:'ğŸ’¡', label:'ì´ë¦„' },
        { id:'ideaDetail', icon:'ğŸ› ', label:'ì„¤ëª…' },
      ];
      var nodes = steps.map(function(s){
        var d=document.createElement('div'); d.className='mini-sticker'; d.title=s.label;
        d.innerHTML = '<span aria-hidden="true">'+s.icon+'</span><span class="label">'+s.label+'</span>';
        holder.appendChild(d); return d;
      });
      function validate(){
        var v1 = !!document.getElementById('age').value;
        var v2 = !!document.getElementById('nickname').value.trim();
        var v3 = document.getElementById('problem').value.trim().length >= 5;
        var v4 = !!document.getElementById('ideaName').value.trim();
        var v5 = document.getElementById('ideaDetail').value.trim().length >= 10;
        [v1,v2,v3,v4,v5].forEach(function(ok,i){ nodes[i].classList.toggle('done', ok); });
      }
      document.getElementById('ideaForm').addEventListener('input', validate);
      document.getElementById('ideaForm').addEventListener('change', validate);
      validate();
    }

    /* íŒíŠ¸ ìŒì„± */
    function initHints(){
      var MP3_NICK = 'ë³„ëª…ì•ˆë‚´ë©˜íŠ¸.mp3';
      var MP3_IDEA = 'ì•„ì´ë””ì–´ì„¤ëª…ë©˜íŠ¸.mp3';
      function ensureHintAudio(id, src){
        var a = document.getElementById(id);
        if(!a){ a = document.createElement('audio'); a.id = id; a.preload = 'none'; document.body.appendChild(a); }
        a.src = src; return a;
      }
      var aNick = ensureHintAudio('hintNickname',   MP3_NICK);
      var aIdea = ensureHintAudio('hintIdeaDetail', MP3_IDEA);
      var once={once:true,passive:true};
      var nick = document.getElementById('nickname');
      var idea = document.getElementById('ideaDetail');
      if(nick){
        nick.addEventListener('pointerdown', function(){ playOne(aNick); }, once);
        nick.addEventListener('focus',       function(){ playOne(aNick); }, once);
      }
      if(idea){
        idea.addEventListener('pointerdown', function(){ playOne(aIdea); }, once);
        idea.addEventListener('focus',       function(){ playOne(aIdea); }, once);
      }
    }

    /* ì¸íŠ¸ë¡œ ë¹„ë””ì˜¤ ë†’ì´ ê³„ì‚° */
    function fitIntroVideo(){
      function fit(){
        var introSec = document.querySelector('#intro .intro');
        var title    = document.querySelector('#intro .intro-top');
        var main     = document.querySelector('#intro .intro-main');
        var video    = document.querySelector('#intro video');
        var cta      = document.getElementById('toForm');
        var footer   = document.querySelector('#intro .footer-logo');
        if(!introSec || !video) return;

        var vh = (window.visualViewport ? window.visualViewport.height : window.innerHeight);
        var cs = getComputedStyle(introSec);
        var padY = parseFloat(cs.paddingTop) + parseFloat(cs.paddingBottom);
        var h = function(el){ return el ? el.getBoundingClientRect().height : 0; };
        var others = h(title)+h(main)+h(cta)+h(footer)+24+padY;
        var avail = Math.max(140, vh - others) - 6;
        video.style.maxHeight = avail + 'px';
      }
      window.addEventListener('load',  fit, {once:true});
      window.addEventListener('resize', fit);
      if (window.visualViewport) visualViewport.addEventListener('resize', fit);
      requestAnimationFrame(fit);
    }

    /* ê²Œì´ì§€ */
    function initGauge(){
      var detail=document.getElementById('ideaDetail');
      var bar=document.getElementById('charBar');
      var msg=document.getElementById('charMsg');
      var count=document.getElementById('charCount');
      function update(){
        var len=(detail.value||'').trim().length;
        var pct=Math.min(len/70*100,100);
        bar.style.width=pct+'%';
        if(count) count.textContent = len+'ì';

        if(len<30){
          bar.style.background='#ffcc00';
          msg.textContent='ğŸŒ± ì•„ì§ ìƒê°ì˜ ì”¨ì•— ë‹¨ê³„ì˜ˆìš”.';
        } else if(len<40){
          bar.style.background='linear-gradient(90deg,#a8e6c3,#7bd49a)';
          msg.textContent='ğŸ‰ ë””ëª¨ ìŠ¤íƒ¬í”„ íšë“!';
        } else if(len<50){
          bar.style.background='linear-gradient(90deg,#8ac7ff,#4f92ff)';
          msg.textContent='ğŸ’« ë§Œì  ê°€ëŠ¥ì„± ë„ë‹¬!';
        } else if(len<70){
          bar.style.background='linear-gradient(90deg,#a48bff,#6a5acd)';
          msg.textContent='ğŸ’ ë ˆì–´ ìŠ¤íƒ¬í”„ ì¶”ì²¨ê¶Œ íšë“!';
        } else {
          bar.style.background='linear-gradient(90deg,red,orange,yellow,green,blue,indigo,violet)';
          msg.textContent='ğŸŒˆ ë ˆì–´ ìŠ¤íƒ¬í”„ ë‹¹ì²¨ í™•ë¥  2ë°° ê°•í™”!';
        }
      }
      detail.addEventListener('input',update,{passive:true}); update();
    }

    /* ê°œì¸ì •ë³´ ë™ì˜ í† ê¸€ */
    function initEmailToggle(){
      var consent = document.getElementById('emailConsent');
      var block   = document.getElementById('emailBlock');
      var email   = document.getElementById('parentEmail');
      var toggle = function(){
        var on = !!consent.checked;
        block.style.display = on ? 'block' : 'none';
        consent.setAttribute('aria-expanded', on ? 'true' : 'false');
        if(!on){ email.value=''; }
      };
      consent.addEventListener('change', toggle, {passive:true}); toggle();
    }

    /* ì¹­ì°¬ë¬¸êµ¬ ëœë¤ */
    function setComplimentText(){
      var el = document.getElementById('complimentText'); if(!el) return;
      var lines = [
        "ğŸ¤© ì™€ìš°! ì‹¤í–‰ë ¥ë„ ê¸°ëŒ€ë¼",
        "ğŸ’¡ ì•„ì´ë””ì–´ê°€ í†¡! íŠ€ì—ˆì–´",
        "ğŸ‘ ë¬¸ì œì •ì˜ê°€ ê¹”ë”í–ˆì–´",
        "ğŸš€ ìƒìƒë ¥ ë ˆë²¨ì—…! ë‹¤ìŒë„ ê°€ì",
        "ğŸ”§ ì´ê±´ ì§„ì§œ ì¨ë³´ê³  ì‹¶ë‹¤",
        "ğŸ§  ì²œì¬ì˜ ëƒ„ìƒˆê°€â€¦!"
      ];
      el.textContent = 'ğŸ’¬ ' + lines[Math.floor(Math.random()*lines.length)];
    }

    /* ë³„ì  ì• ë‹ˆ */
    function animateStarsToScore(id, score){
      return new Promise(function(resolve){
        var el=document.getElementById(id); if(!el) return resolve();
        el.innerHTML = '<span class="star">â˜…</span>'.repeat(5);
        var full=Math.floor(score);
        var hasHalf = (score-full) >= 0.5;
        var idx=0, target=full + (hasHalf?1:0);
        (function step(){
          if(idx>=target){ setTimeout(resolve, 250); return; }
          var s=el.children[idx];
          if(idx<full){ s.classList.add('full'); }
          else if(hasHalf){ s.classList.add('half'); }
          idx++; setTimeout(step, STAR_STEP_MS);
        })();
      });
    }

    /* ì œì¶œ ì²˜ë¦¬ */
    function bindFormSubmit(){
      document.getElementById('ideaForm').addEventListener('submit', async function(e){
        e.preventDefault();
        await resumeAudio();

        // ê°’
        var age=document.getElementById('age').value;
        var nickname=document.getElementById('nickname').value.trim();
        var problem=document.getElementById('problem').value.trim();
        var ideaName=document.getElementById('ideaName').value.trim();
        var ideaDetail=document.getElementById('ideaDetail').value.trim();

        // ë™ì˜ì‹œ ì´ë©”ì¼ ê²€ì‚¬
        var consent = document.getElementById('emailConsent').checked;
        var emailVal= document.getElementById('parentEmail').value.trim();

        if(!age||!nickname||!problem||!ideaName||ideaDetail.length<10){
          alert('ëª¨ë“  í•­ëª©ì„ ì±„ì›Œì¤˜! (ì„¤ëª…ì€ 10ì ì´ìƒ)'); return;
        }
        if(consent){
          var emailOk = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(emailVal);
          if(!emailOk){ alert('ì´ë©”ì¼ í˜•ì‹ì´ ë§ì§€ ì•Šì•„! ì˜ˆ: parent@example.com'); return; }
        }

        // í™”ë©´ ì „í™˜
        document.getElementById('formScreen').classList.remove('active');
        document.getElementById('resultScreen').classList.add('active');
        updateScreenFlag();

        // ë°ì´í„° ë°”ì¸ë”©
        document.getElementById('inventorName').textContent=nickname;
        document.getElementById('ideaDisplay').textContent=ideaName;
        var dimo=document.getElementById('dimoImg');
        dimo.src=dimoImages[Math.floor(Math.random()*dimoImages.length)];
        dimo.style.display='block';

        // ì ìˆ˜ ê³„ì‚°
        var len=ideaDetail.length;
        var didPerfect=false, gotRare=false;
        var scores = (len>=40 && Math.random()<0.04)
          ? (didPerfect=true, {creativity:5,feasibility:5,technical:5})
          : {
              creativity: Math.round((3.5+Math.random()*1.5)*2)/2,
              feasibility: Math.round((3.5+Math.random()*1.5)*2)/2,
              technical: Math.round((3.5+Math.random()*1.5)*2)/2
            };

        await animateStarsToScore('creativity',  scores.creativity);
        await animateStarsToScore('feasibility', scores.feasibility);
        await animateStarsToScore('technical',   scores.technical);
        setComplimentText();
setComplimentText();

// âœ… êµ¬ê¸€í¼ ì „ì†¡ (í™”ë©´ ì—°ì¶œê³¼ ë…ë¦½)
try {
  var compliment = document.getElementById('complimentText').textContent.replace(/^ğŸ’¬\s*/, '');
  if (typeof window.DIMO_SUBMIT === 'function') {
    window.DIMO_SUBMIT({
      title:      ideaName,   // ë°œëª…í’ˆ ì´ë¦„
      inventor:   nickname,   // ë³„ëª…(ë°œëª…ì)
      compliment: compliment  // ì¹­ì°¬ë¬¸êµ¬
    });
  }
} catch (e) {
  console.warn('[DIMO] í¼ ì „ì†¡ ìŠ¤í‚µ:', e);
}

        // ìŠ¤íƒ¬í”„ ì¢…ë¥˜
        var stampSrc=null;
        if(len>=30) stampSrc='ë””ëª¨ìŠ¤íƒ¬í”„01.png';
        if(didPerfect){ stampSrc='ë””ëª¨ìŠ¤íƒ¬í”„ë§Œì 02.png'; }
        else{
          var rareP = (len>=70) ? 0.06 : (len>=50) ? 0.03 : 0;
          if(Math.random()<rareP){ stampSrc='ë””ëª¨ìŠ¤íƒ¬í”„ë ˆì–´03.png'; gotRare=true; }
        }

        // ìŠ¤íƒ¬í”„ + íš¨ê³¼
        setTimeout(async function(){
          if(stampSrc){
            var dimoWrap = document.querySelector('#resultScreen .dimo-wrap');
            if(dimoWrap){
              document.getElementById('stampArea').innerHTML='';
              var rect = dimoWrap.getBoundingClientRect();
              var visSize = Math.min(rect.width, rect.height) * STAMP_VIS_RATIO;
              var baseSize = Math.round(visSize / 1.08);

              var wrap = document.createElement('div');
              wrap.className = 'stamp-wrap';
              wrap.style.position = 'absolute';
              wrap.style.right = '4px';
              wrap.style.bottom = '4px';
              wrap.style.width = baseSize+'px';
              wrap.style.height = baseSize+'px';
              wrap.innerHTML = '<img src="'+stampSrc+'" alt="ìŠ¤íƒ¬í”„" class="stamp-img stamp-enter" style="--r:'+(Math.random()*8-4).toFixed(1)+'deg">';
              dimoWrap.appendChild(wrap);

              if(navigator.vibrate){ try{ navigator.vibrate(30);}catch(e){} }

              var aPerfect = ensureAudioLocal('stampPerfect','ë§Œì ìš©ì¹­ì°¬.mp3');
              var aRare    = ensureAudioLocal('stampRare','í–‰ìš´ì˜ë ˆì–´í…œì¹­ì°¬.mp3');
              if(didPerfect)      playOne(aPerfect);
              else if(gotRare)    playOne(aRare);
            }
          }
          fireConfetti(1500);
          playComplimentWithFallback();
          writeDateTime(); // ì¹´ë“œ ë‚´ë¶€ ìš°í•˜ë‹¨
        }, 600);
      });
    }

    function ensureAudioLocal(id, src){
      var a = document.getElementById(id);
      if(!a){ a=document.createElement('audio'); a.id=id; a.preload='none'; document.body.appendChild(a); }
      a.src=src; return a;
    }

    /* ì €ì¥ */
    function initSaver(){
      var btn=document.getElementById('saveBtn'), toast=document.getElementById('toast');
      var showToast=function(){ toast.classList.add('show'); setTimeout(function(){toast.classList.remove('show')},1600); };
      btn.addEventListener('click', async function(){
        try{ await ensureScript('https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js'); }
        catch(e){ showToast(); return; }
        var card=document.getElementById('card');
        var scale=Math.min(MOBILE?1.2:1.5, window.devicePixelRatio||1);
        window.html2canvas(card,{scale:scale, useCORS:true}).then(function(canvas){
          var link=document.createElement('a');
          link.href=canvas.toDataURL('image/png'); link.download='dimo_card.png';
          if(/iPad|iPhone|iPod/.test(navigator.userAgent)){
            var w=window.open(); if(w&&w.document) w.document.write('<img src="'+link.href+'" style="width:100%">');
          } else link.click();
          showToast();
        }).catch(showToast);
      }, {passive:true});
    }

    /* í™”ë©´ í”Œë˜ê·¸ (ì˜µì…”ë„ ì²´ì´ë‹ ì œê±°) */
    function updateScreenFlag(){
      var introEl  = document.getElementById('intro');
      var formEl   = document.getElementById('formScreen');
      var resultEl = document.getElementById('resultScreen');
      var introActive  = introEl  && introEl.classList.contains('active');
      var formActive   = formEl   && formEl.classList.contains('active');
      var resultActive = resultEl && resultEl.classList.contains('active');
      var screen = introActive ? 'intro' : (formActive ? 'form' : (resultActive ? 'result' : ''));
      document.body.setAttribute('data-screen', screen);
    }
    new MutationObserver(function(){ updateScreenFlag(); })
      .observe(document.body, {subtree:true, attributes:true, attributeFilter:['class']});

    /* ì¸íŠ¸ë¡œ ìŠ¤íŒŒí´ */
    function enableIntroSpark(){
      var root  = document.querySelector('#intro .intro');
      var layer = document.getElementById('fxLayer');
      if(!root || !layer) return;

      function burst(x, y){
        var N = 12;
        for(var i=0;i<N;i++){
          var el = document.createElement('span');
          el.className = 'spark';
          el.textContent = (i%3===0) ? 'âœ¦' : (i%4===0 ? 'â˜…' : 'âœ§');
          var ang = Math.random()*Math.PI*2;
          var r   = 52 + Math.random()*68;
          var tx  = (Math.cos(ang)*r).toFixed(1) + 'px';
          var ty  = (Math.sin(ang)*r) + 'px';
          el.style.left = x + 'px';
          el.style.top  = y + 'px';
          el.style.setProperty('--tx', tx);
          el.style.setProperty('--ty', ty);
          el.style.color = 'hsl('+(200 + Math.random()*140)+', 85%, 60%)';
          layer.appendChild(el);
          el.addEventListener('animationend', function(){ el.remove(); }, {once:true});
        }
      }

      var handler = function(e){
        var p = (e.touches && e.touches[0]) ? e.touches[0] : e;
        burst(p.clientX, p.clientY);
      };

      root.addEventListener('pointerdown', handler, {passive:true, capture:true});
      root.addEventListener('touchstart',  handler, {passive:true, capture:true});
    }

    /* ì¹´ë“œ ë‚ ì§œ */
    function writeDateTime(){
      var el=document.getElementById('cardDate'); if(!el) return;
      var d=new Date(), p=function(n){return String(n).padStart(2,'0');};
      el.textContent = d.getFullYear()+'.'+p(d.getMonth()+1)+'.'+p(d.getDate())+' '+p(d.getHours())+':'+p(d.getMinutes())+':'+p(d.getSeconds());
    }
  </script>
<!-- ===== DIMO LOGO HOTFIX v3 (logo path/caching fix + PC center 2x + 2cm CTA) ===== -->
<style>
  /* ê³µí†µ: ë¡œê³ ê°€ ë‹¤ë¥¸ ìš”ì†Œì— ê°€ë¦¬ì§€ ì•Šë„ë¡ */
  .footer-logo{ z-index:5; }
  .footer-logo .footer-logo-img{
    display:block; width:100%; height:100%; object-fit:contain;
  }

  /* ì¸íŠ¸ë¡œ CTA ë²„íŠ¼: ì •í™•íˆ 2cm ì•„ë˜ */
  #toForm{ margin-top:2cm !important; }

  /* PC: ë¡œê³  ì¤‘ì•™ 2ë°° í™•ëŒ€(ì¸íŠ¸ë¡œ/ê²°ê³¼ ê³µí†µ) + ì¹´ë“œ í•˜ë‹¨ ì—¬ìœ  */
  @media (min-width:1024px){
    #intro .footer-logo,
    #resultScreen .footer-logo{
      transform:translateX(-50%) scale(2) !important;
      transform-origin:center bottom;
    }
    #resultScreen #card{ padding-bottom:180px !important; }
  }

  /* ëª¨ë°”ì¼: í™ˆë°” ê°€ë¦¼ ë°©ì§€ */
  @media (max-width:600px){
    .footer-logo{
      bottom:max(22px, calc(env(safe-area-inset-bottom) + 18px)) !important;
    }
  }
</style>

<script>
/* ë¡œê³  ê²½ë¡œ ìë™ íƒìƒ‰ + ìºì‹œ ë¬´ë ¥í™” + ì¡´ì¬í•˜ëŠ” íŒŒì¼ë§Œ ì‚¬ìš© */
(function injectDimoLogo(){
  // 1) í›„ë³´ í™•ì¥ì & ê²½ë¡œ ì¡°í•© ìƒì„±
  const exts  = ['png','webp','jpg','jpeg','svg','PNG','JPG'];
  const paths = (()=> {
    const list = [];
    const p = location.pathname.endsWith('/')
      ? location.pathname
      : location.pathname.replace(/\/[^\/]*$/, '/');   // /repo/index.html -> /repo/
    list.push('', './', p, '/');                        // ìƒëŒ€, í˜„ì¬í´ë”, í”„ë¡œì íŠ¸ ë£¨íŠ¸, ë„ë©”ì¸ ë£¨íŠ¸
    return [...new Set(list)];
  })();

  const candidates = [];
  paths.forEach(base => exts.forEach(ext => candidates.push(`${base}logo_dimo.${ext}`)));

  // 2) ê° ë¡œê³  <img>ì— ëŒ€í•´ ì‹¤ì œ ë¡œë“œ ê°€ëŠ¥í•œ ê²½ë¡œë¥¼ ì°¾ì•„ ì ìš©
  function applyLogo(img, urls, i=0){
    if(i >= urls.length){                // ì „ë¶€ ì‹¤íŒ¨ â†’ ì˜ì—­ ìˆ¨ê¹€(ê¹¨ì§„ ì•„ì´ì½˜ ë°©ì§€)
      const box = img.closest('.footer-logo'); if(box) box.style.display='none';
      console.warn('[DIMO] ë¡œê³  íŒŒì¼ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤:', urls);
      return;
    }
    const url = urls[i];
    const test = new Image();
    test.decoding = 'async';
    test.onload  = ()=>{ img.src = url + `?v=${Date.now()}`; };  // ìºì‹œ ë¬´ë ¥í™”
    test.onerror = ()=> applyLogo(img, urls, i+1);
    test.src = url;
  }

  document.querySelectorAll('.footer-logo img.footer-logo-img').forEach(img=>{
    applyLogo(img, candidates);
  });

  // iOS ì•ˆì „ì˜ì—­ ëŒ€ì‘: viewport-fit=cover ë³´ê°•(ì—†ì„ ë•Œë§Œ ì¶”ê°€)
  try{
    const hasVF = [...document.querySelectorAll('meta[name="viewport"]')]
      .some(m => (m.content||'').includes('viewport-fit=cover'));
    if(!hasVF){
      const m = document.createElement('meta');
      m.name = 'viewport';
      m.content = 'width=device-width, initial-scale=1, viewport-fit=cover';
      document.head.appendChild(m);
    }
  }catch(e){}
})();
</script>
<!-- ===== /DIMO LOGO HOTFIX v3 ===== -->
<!-- ===== CTA HEIGHT PATCH (1cm up) ===== -->
<style>
  /* ê¸°ì¡´ 2cmì—ì„œ ì •í™•íˆ 1cmë¡œ */
  #toForm { margin-top: 1cm !important; }
</style>
<!-- ===== /CTA HEIGHT PATCH ===== -->
<!-- ===== MOBILE LOGO VISIBILITY HOTFIX v2 (append-only) ===== -->
<style>
  /* ëª¨ë°”ì¼ì—ì„œ ì¸íŠ¸ë¡œ ë¡œê³ ê°€ ë¹„ë””ì˜¤/í™ˆë°”ì— ê°€ë ¤ì§€ì§€ ì•Šê²Œ ê³ ì • */
  @media (max-width: 600px){
    #intro .footer-logo{
      position: fixed !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      bottom: calc(12px + env(safe-area-inset-bottom)) !important;
      width: 70vw !important;
      height: auto !important;
      z-index: 10000 !important;
      pointer-events: none !important;
      display: block !important;
      visibility: visible !important;
    }
    #intro .footer-logo .footer-logo-img{
      display: block !important;
      width: 100% !important;
      height: auto !important;
      visibility: visible !important;
      -webkit-transform: translateZ(0); /* iOS ë¦¬í˜ì¸íŠ¸ íŒíŠ¸ */
      transform: translateZ(0);
    }
  }
</style>

<script>
/* ëª¨ë°”ì¼ ë¡œê³ ê°€ file:// ê²½ë¡œì—ì„œ ì•ˆ ë³´ì´ëŠ” ì´ìŠˆ ëŒ€ì‘:
   1) ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ì—†ì´ ì›ë³¸ íŒŒì¼ë¶€í„° ì‹œë„
   2) http/httpsì¼ ë•Œë§Œ ?v= ìºì‹œë²„ìŠ¤í„° ì‚¬ìš©
   3) webp/jpg/ëŒ€ì†Œë¬¸ìê¹Œì§€ í›„ë³´ ìˆœí™˜
*/
(function(){
  var useBust = (location.protocol === 'http:' || location.protocol === 'https:');
  var CANDIDATES = (window.LOGO_CANDIDATES || [
    'logo_dimo.png','logo_dimo.webp','logo_dimo.jpg','logo_dimo.PNG','logo_dimo.JPG'
  ]);

  function hideBox(img){
    var box = img.closest('.footer-logo');
    if (box) box.style.display = 'none';
  }

  function tryLoad(img, i, withBust){
    if(i >= CANDIDATES.length){ hideBox(img); return; }
    var base = CANDIDATES[i];
    var url  = (withBust && useBust) ? (base + '?v=' + Date.now()) : base;

    var test = new Image();
    test.onload = function(){
      // iOSì—ì„œ 0px ë Œë” íšŒí”¼
      if (test.naturalWidth && test.naturalHeight){
        img.setAttribute('width',  test.naturalWidth);
        img.setAttribute('height', test.naturalHeight);
      }
      img.style.visibility = 'visible';
      img.src = url; // ìµœì¢… ë°˜ì˜
    };
    test.onerror = function(){
      if(!withBust && useBust){
        // bust ì—†ì´ ì‹¤íŒ¨ â†’ bust í•œ ë²ˆë§Œ ì‹œë„
        tryLoad(img, i, true);
      }else{
        // ë‹¤ìŒ í›„ë³´ë¡œ
        tryLoad(img, i+1, false);
      }
    };
    test.src = url;
  }

  function boot(){
    var imgs = document.querySelectorAll('.footer-logo .footer-logo-img');
    if(!imgs.length) return;

    imgs.forEach(function(img){
      try{ img.decoding = 'async'; img.loading = 'eager'; }catch(e){}
      // ì´ë¯¸ ì •ìƒ ë¡œë“œë©´ ìŠ¤í‚µ
      if(img.complete && img.naturalWidth > 0) return;

      // srcê°€ ë¹„ì–´ìˆìœ¼ë©´ ìš°ì„  ê¸°ë³¸ íŒŒì¼ë¡œ ì„¸íŒ…
      if(!img.getAttribute('src')) img.src = CANDIDATES[0];

      // ê·¸ë˜ë„ ì‹¤íŒ¨í•˜ë©´ í›„ë³´ ìˆœíšŒ ì‹œì‘
      if(img.complete && !img.naturalWidth){
        tryLoad(img, 0, false);
      }else{
        img.addEventListener('error', function onerr(){
          img.removeEventListener('error', onerr);
          tryLoad(img, 0, false);
        }, {once:true});
      }

      // iOS ê·¸ë¦¬ê¸° ëˆ„ë½ ë¦¬í˜ì¸íŠ¸ íŒíŠ¸
      requestAnimationFrame(function(){
        img.style.willChange = 'transform';
        img.style.transform = 'translateZ(0)';
      });
    });
  }

  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', boot);
  } else {
    boot();
  }

  // ê°œë°œììš© ê°„ë‹¨ ì ê²€ í—¬í¼
  window.DEBUG_LOGO = function(){
    var im = document.querySelector('#intro .footer-logo-img');
    if(!im) return console.log('no logo');
    console.log('src:', im.src, 'complete:', im.complete, 'natural:', im.naturalWidth, im.naturalHeight);
  };
})();
</script>
<!-- ===== /MOBILE LOGO VISIBILITY HOTFIX v2 ===== -->
<!-- ===== FORM SUBMIT TEXT PATCH (âœ‰ ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°) ===== -->
<script>
(function(){
  function patchSubmitLabel(){
    var form = document.getElementById('ideaForm');
    if(!form) return;
    var btn = form.querySelector('button[type="submit"]');
    if(btn){
      // í…ìŠ¤íŠ¸ë§Œ êµì²´, êµ¬ì¡°/ID/í´ë˜ìŠ¤ ë¶ˆë³€
      btn.innerHTML = 'âœ‰ ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°';
      btn.setAttribute('aria-label','ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°');
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', patchSubmitLabel);
  }else{
    patchSubmitLabel();
  }
})();
</script>
<!-- ===== /FORM SUBMIT TEXT PATCH ===== -->
<!-- ===== PATCH: FUN EFFECTS PACK v1 (append-only, no DOM edits) ===== -->
<style>
/* 1) Intro Aurora overlay */
#intro .intro::before{
  content:""; position:absolute; inset:0; pointer-events:none; z-index:0;
  background:
    radial-gradient(1200px 600px at 10% 20%, rgba(79,146,255,.18), transparent 60%),
    radial-gradient(900px 500px at 90% 10%, rgba(164,139,255,.16), transparent 60%),
    radial-gradient(800px 800px at 50% 100%, rgba(165,230,184,.16), transparent 60%);
  animation: auroraMove 16s ease-in-out infinite alternate;
}
@keyframes auroraMove{
  0%{ filter:hue-rotate(0deg) saturate(1); transform:translateY(0)}
  100%{ filter:hue-rotate(30deg) saturate(1.1); transform:translateY(-2%)}
}

/* 2) CTA/Save breathing glow */
.btn-primary.glow{
  animation: btnGlow 2.6s ease-in-out infinite;
  box-shadow:0 10px 22px rgba(0,0,0,.12), 0 0 0 0 rgba(123,212,154,.45);
}
@keyframes btnGlow{
  0%,100%{ box-shadow:0 10px 22px rgba(0,0,0,.12), 0 0 0 0 rgba(123,212,154,.45) }
  50%{    box-shadow:0 14px 26px rgba(0,0,0,.14), 0 0 0 12px rgba(123,212,154,0) }
}

/* 3) Logo shimmer sweep */
.footer-logo::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:linear-gradient(120deg, transparent 45%, rgba(255,255,255,.55) 50%, transparent 55%);
  transform:translateX(-120%); mix-blend-mode:screen;
  animation: logoShine 4.8s ease-in-out infinite;
}
@keyframes logoShine{
  0%,10%{ transform:translateX(-120%) }
  40%{   transform:translateX(120%) }
  100%{  transform:translateX(120%) }
}

/* 4) Stars pop when filled */
@keyframes starPop{0%{transform:scale(.6) rotate(-8deg)}70%{transform:scale(1.15) rotate(3deg)}100%{transform:scale(1) rotate(0)}}
.stars .star.full, .stars .star.half{ animation:starPop .28s cubic-bezier(.2,1.2,.2,1) both; }

/* 5) Stamp ink ring (runs on insertion) */
.stamp-wrap::after{
  content:""; position:absolute; right:0; bottom:0; width:100%; height:100%;
  border-radius:50%; border:3px solid rgba(20,84,58,.25);
  transform:scale(.6); opacity:0; animation:inkRing .6s ease-out .05s both;
}
@keyframes inkRing{0%{transform:scale(.6);opacity:0}70%{opacity:.45}100%{transform:scale(1.2);opacity:0}}

/* 6) Mini-sticker pop on .done */
@keyframes stickerPop{0%{transform:scale(.8)}60%{transform:scale(1.15)}100%{transform:scale(1)}}
.mini-sticker.done{ animation:stickerPop .25s cubic-bezier(.2,1.1,.2,1); }

/* 7) Compliment box tada (JS toggles .tada) */
@keyframes cboxTada{0%{transform:scale(1)}35%{transform:scale(1.06) rotate(-1deg)}70%{transform:scale(1.06) rotate(1deg)}100%{transform:scale(1)}}
.cbox.tada{ animation:cboxTada .5s ease both; }
</style>

<script>
(function funEffectsPack(){
  // add subtle glow to primary buttons we already have
  function addGlow(){
    var cta=document.getElementById('toForm');
    var save=document.getElementById('saveBtn');
    if(cta)  cta.classList.add('glow');
    if(save) save.classList.add('glow');
  }
  // compliment text change -> tiny tada
  function watchCompliment(){
    var el=document.getElementById('complimentText'); if(!el) return;
    var last=el.textContent;
    var mo=new MutationObserver(function(){
      if(el.textContent!==last){
        last=el.textContent;
        el.classList.remove('tada'); void el.offsetWidth; el.classList.add('tada');
      }
    });
    mo.observe(el,{characterData:true,childList:true,subtree:true});
  }
  if(document.readyState==='loading'){
    document.addEventListener('DOMContentLoaded', function(){ addGlow(); watchCompliment(); });
  }else{ addGlow(); watchCompliment(); }
})();
</script>
<!-- ===== /PATCH: FUN EFFECTS PACK v1 ===== -->
<!-- ===== FUN EFFECTS PACK v2: Moving goodies (append-only) ===== -->
<style>
/* ê³µí†µ: ì €ì „ë ¥ ëª¨ë“œ ëŒ€ì‘ */
@media (prefers-reduced-motion: reduce){
  .no-motion { animation: none !important; transition: none !important; }
}

/* 1) ë²„íŠ¼ ripple */
.btn{ overflow:hidden; }
.btn .ripple {
  position:absolute; left:0; top:0; border-radius:50%;
  transform:translate(-50%,-50%); pointer-events:none;
  background:radial-gradient(circle, rgba(255,255,255,.55) 0%, rgba(255,255,255,0) 60%);
  width:0; height:0; opacity:.9; mix-blend-mode:screen;
  animation:ripple-expand .6s ease-out forwards;
}
@keyframes ripple-expand {
  to { width:280px; height:280px; opacity:0; }
}

/* 2) ì¸íŠ¸ë¡œ ë– ì˜¤ë¥´ëŠ” ì´ëª¨ì§€(ê°€ë²¼ìš´ í’ì„  ëŠë‚Œ) */
.float-emoji{
  position:fixed; bottom:-32px; font-size:clamp(18px,4vw,26px); z-index:1200;
  will-change: transform, opacity; filter:drop-shadow(0 2px 6px rgba(0,0,0,.25));
  animation:rise 7.2s linear forwards, sway 3.2s ease-in-out infinite alternate;
  pointer-events:none; opacity:.9;
}
@keyframes rise   { to { transform: translateY(-110vh) } }
@keyframes sway   { from{ transform: translateX(-14px)} to{ transform: translateX(14px)} }

/* 3) ê²°ê³¼ ì¹´ë“œ íŒ¨ëŸ´ë™ìŠ¤ */
#resultScreen .wrap{ perspective:1000px; }
#card.parallax{
  transform-style:preserve-3d; transition: transform .08s ease;
}
#card.parallax.off{
  transition: transform .25s ease; transform: rotateX(0) rotateY(0) translateZ(0);
}

/* 4) ë””ëª¨ ë‘¥ì‹¤ë‘¥ì‹¤(ë˜í¼ì— ì ìš©: ê¸°ì¡´ transformê³¼ ì¶©ëŒ ë°©ì§€) */
#resultScreen .dimo-wrap.bob { animation: dimoBob 3s ease-in-out infinite; transform-origin:50% 90%; }
@keyframes dimoBob { 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-8px) } }

/* 5) ê²°ê³¼ í™”ë©´ ì»¤ì„œ/í„°ì¹˜ ë°˜ì§ ê¼¬ë¦¬ */
.trail{
  position:fixed; left:0; top:0; transform:translate(-50%,-50%) scale(1);
  font-size:12px; opacity:.9; pointer-events:none; z-index:1400;
  filter:drop-shadow(0 2px 6px rgba(0,0,0,.28));
  animation: trailOut .8s ease-out forwards;
}
@keyframes trailOut { to { opacity:0; transform:translate(-50%,-50%) scale(.4) } }
</style>

<script>
(function movingGoodies(){
  // ì‚¬ìš© ìŠ¤ìœ„ì¹˜ (ì›í•˜ë©´ falseë¡œ êº¼ë„ ë¨)
  var CFG = {
    ripple: true,
    floatEmoji: true,
    cardParallax: true,
    dimoBob: true,
    resultTrail: true
  };

  // ì €ì „ë ¥/ê°ì† í™˜ê²½ì´ë©´ ëª¨ë‘ ë”
  if (window.matchMedia && matchMedia('(prefers-reduced-motion: reduce)').matches){
    for (var k in CFG) CFG[k] = false;
  }

  // 1) ë²„íŠ¼ ripple
  function enableRipple(){
    if(!CFG.ripple) return;
    var targets = [document.getElementById('toForm'), document.getElementById('saveBtn')].filter(Boolean);
    targets.forEach(function(btn){
      btn.addEventListener('click', function(e){
        try{
          var r=document.createElement('span'); r.className='ripple';
          var rect=btn.getBoundingClientRect();
          var x=(e.clientX|| (rect.left+rect.width/2)) - rect.left;
          var y=(e.clientY|| (rect.top+rect.height/2)) - rect.top;
          var max=Math.max(rect.width, rect.height)*1.25;
          r.style.left=x+'px'; r.style.top=y+'px';
          r.style.width=r.style.height=max+'px';
          btn.appendChild(r);
          r.addEventListener('animationend', function(){ r.remove(); }, {once:true});
        }catch(_){}
      }, {passive:true});
    });
  }

  // 2) ì¸íŠ¸ë¡œ í’ì„  ì´ëª¨ì§€
  function startFloatEmojis(){
    if(!CFG.floatEmoji) return;
    var root = document.querySelector('#intro .intro');
    var layer= document.getElementById('fxLayer');
    if(!root || !layer) return;
    var EMO = ['ğŸ’¡','â­ï¸','âœ¨','ğŸ”§','ğŸˆ','ğŸš€','ğŸ§ '];

    var timer;
    function spawn(){
      if(!document.body.getAttribute('data-screen')?.includes('intro')) return;
      var el=document.createElement('span');
      el.className='float-emoji';
      el.textContent=EMO[Math.random()*EMO.length|0];
      var left = 10 + Math.random()*80; // vw
      el.style.left = left+'vw';
      el.style.opacity = 0.7 + Math.random()*0.3;
      layer.appendChild(el);
      el.addEventListener('animationend', function(){ el.remove(); }, {once:true});
      timer = setTimeout(spawn, 900 + Math.random()*1200);
    }
    spawn();
    // í™”ë©´ ì „í™˜ë˜ë©´ ì¡°ê¸ˆ ë’¤ ì •ë¦¬
    new MutationObserver(function(){
      if(document.body.getAttribute('data-screen')!=='intro'){ clearTimeout(timer); }
    }).observe(document.body,{attributes:true,attributeFilter:['data-screen']});
  }

  // 3) ê²°ê³¼ ì¹´ë“œ íŒ¨ëŸ´ë™ìŠ¤
  function enableParallax(){
    if(!CFG.cardParallax) return;
    var screen = document.getElementById('resultScreen');
    var card   = document.getElementById('card');
    if(!screen || !card) return;
    card.classList.add('parallax');
    var on = false;

    function move(e){
      if(!on) return;
      var r = card.getBoundingClientRect();
      var px = ( (e.clientX || (r.left+r.width/2)) - r.left ) / r.width;   // 0~1
      var py = ( (e.clientY || (r.top +r.height/2)) - r.top  ) / r.height; // 0~1
      var rx = (0.5 - py) * 6; // Xì¶• ê¸°ìš¸ê¸°
      var ry = (px - 0.5) * 6; // Yì¶• ê¸°ìš¸ê¸°
      card.style.transform = 'rotateX('+rx+'deg) rotateY('+ry+'deg) translateZ(0)';
    }
    function onEnter(){ on = true; card.classList.remove('off'); }
    function onLeave(){ on = false; card.classList.add('off'); card.style.transform=''; }

    screen.addEventListener('pointerenter', onEnter, {passive:true});
    screen.addEventListener('pointermove',  move,    {passive:true});
    screen.addEventListener('pointerleave', onLeave, {passive:true});
    // í„°ì¹˜ ì¥ì¹˜: ì‚´ì§ë§Œ
    screen.addEventListener('touchmove', function(ev){
      if(!on && ev.touches && ev.touches[0]) onEnter();
      move(ev.touches[0]);
    }, {passive:true});
  }

  // 4) ë””ëª¨ ë‘¥ì‹¤ë‘¥ì‹¤: dimo-wrapì— bob í´ë˜ìŠ¤ ë¶€ì—¬ (src ë°”ë€” ë•Œ ê°ì§€)
  function bobDimo(){
    if(!CFG.dimoBob) return;
    var wrap = document.querySelector('#resultScreen .dimo-wrap');
    var img  = document.getElementById('dimoImg');
    if(!wrap || !img) return;
    function arm(){ wrap.classList.add('bob'); }
    img.addEventListener('load', arm, {once:true});
    // í˜¹ì‹œ ì´ë¯¸ ë¡œë“œëœ ìƒíƒœë¼ë©´ ì¦‰ì‹œ
    if(img.complete && img.naturalWidth>0) arm();
  }

  // 5) ê²°ê³¼ í™”ë©´ ì»¤ì„œ ë°˜ì§ ê¼¬ë¦¬
  function enableTrail(){
    if(!CFG.resultTrail) return;
    var screen = document.getElementById('resultScreen');
    if(!screen) return;
    var last=0;
    function spawn(x,y){
      var el=document.createElement('span');
      el.className='trail';
      el.textContent = (Math.random()<.5)?'âœ¦':'âœ§';
      el.style.left=x+'px'; el.style.top=y+'px';
      el.style.color='hsl('+(200+Math.random()*140)+', 85%, 60%)';
      document.body.appendChild(el);
      el.addEventListener('animationend', function(){ el.remove(); }, {once:true});
    }
    function move(e){
      var now = performance.now();
      if(now - last < 50) return; // throttle
      last = now;
      var p = (e.touches && e.touches[0]) ? e.touches[0] : e;
      spawn(p.clientX, p.clientY);
    }
    screen.addEventListener('pointermove', move, {passive:true});
    screen.addEventListener('touchmove', move, {passive:true});
  }

  function boot(){
    enableRipple();
    startFloatEmojis();
    enableParallax();
    bobDimo();
    enableTrail();
  }
  if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', boot);
  else boot();
})();
</script>
<!-- ===== /FUN EFFECTS PACK v2 ===== -->
<!-- ===== DESIGN POLISH PATCH v1 (append-only) ===== -->
<style>
/* ì¹´ë“œ ì™¸ê³½/ê·¸ë¦¼ì ì‚´ì§ ë¶€ë“œëŸ½ê²Œ */
#resultScreen .card{
  border-color:#bfead3 !important;
  box-shadow:0 8px 20px rgba(0,0,0,.08) !important;
}

/* ì œëª© ë°°ë„ˆ ì—¬ë°±/ìê°„ ë¯¸ì„¸ ë³´ì • */
#resultScreen .banner{
  margin:6px 0 10px !important;
  letter-spacing: .2px;
}

/* ì¹­ì°¬ ë°•ìŠ¤ ê°€ë… â†‘ (ì‚´ì§ ì‘ê²Œ/ê°„ê²© ê· ë“±) */
#resultScreen .cbox{
  font-size:clamp(17px,4vw,19px) !important;
  padding:10px 12px !important;
}

/* ë³„ì  í–‰ ê· ì¼í™”: í–‰ íŒ¨ë”©Â·ë³„ í¬ê¸°Â·ê°„ê²© í†µì¼ */
#resultScreen .ratings{ gap:10px !important; }
#resultScreen .rating{
  padding:8px 12px !important;
  align-items:center !important;
}
#resultScreen .rating h3{
  font-size:15px !important; color:#1a402d !important; margin-right:6px !important;
}
#resultScreen .stars{ font-size:21px !important; gap:4px !important; }

/* ë””ëª¨ ì¡´ì¬ê° + ê·¸ë¦¼ì */
#resultScreen .dimo{ width:clamp(110px,26vw,130px) !important; }
#resultScreen .dimo-wrap{ filter:drop-shadow(0 6px 12px rgba(0,0,0,.10)); }

/* ì¹´ë“œ í•˜ë‹¨ ë¡œê³  ì‚´ì§ ì„ ëª…í•˜ê²Œ */
#resultScreen .footer-logo{
  opacity:.98; filter:drop-shadow(0 6px 14px rgba(0,0,0,.10));
}

/* ë©”íƒ€ ì •ë³´ ë°•ìŠ¤ í†¤ ë‹¤ìš´ */
#resultScreen .info{
  background:#f4fff8 !important; border-color:#c9efd7 !important;
  font-size:15px !important;
}

/* ë‚ ì§œëŠ” ì¡°ìš©í•˜ê²Œ(ì‹œê°ì  ìš°ì„ ìˆœìœ„ â†“) */
#cardDate{ font-size:12px !important; opacity:.75 !important; }

/* ì¸íŠ¸ë¡œ ì œëª© í–‰ê°„/ì—¬ë°± ì•½ê°„ ì—¬ìœ  */
#intro .intro-top{ margin-bottom:6px !important; }
</style>
<!-- ===== /DESIGN POLISH PATCH v1 ===== -->
<!-- ===== /MOBILE LOGO VISIBILITY HOTFIX v2 ===== -->

<!-- â†“â†“â†“ ì—¬ê¸° ë°”ë¡œ ì•„ë˜ì— ë¶™ì—¬ â†“â†“â†“ -->
<!-- ===== DIMO BOB ONLY (append-only) ===== -->
<style>
#resultScreen .dimo-wrap.bob{ animation: dimoBob 3s ease-in-out infinite; transform-origin:50% 90%; }
@keyframes dimoBob { 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-8px) } }
</style>
<script>
(function(){ 
  var w=document.querySelector('#resultScreen .dimo-wrap');
  var img=document.getElementById('dimoImg');
  if(!w||!img) return;
  function arm(){ w.classList.add('bob'); }
  img.addEventListener('load', arm, {once:true});
  if(img.complete && img.naturalWidth>0) arm();
})();
</script>
<!-- ===== /DIMO BOB ONLY ===== -->
<!-- ===== DIMO MOBILE LOGO FINAL PATCH (append-only) ===== -->
<script>
(function fixDimoLogoOnce(){
  // http(s)ì¼ ë•Œë§Œ ìºì‹œë²„ìŠ¤í„° í—ˆìš©
  var isHTTP = /^https?:$/i.test(location.protocol);

  // ë¡œê³  í›„ë³´ (ëŒ€ì†Œë¬¸ì/í™•ì¥ì ë‹¤ì–‘í™”)
  var NAMES = (window.LOGO_CANDIDATES || [
    'logo_dimo.png','logo_dimo.webp','logo_dimo.jpg','logo_dimo.jpeg','logo_dimo.svg',
    'logo_dimo.PNG','logo_dimo.JPG'
  ]);

  // ë² ì´ìŠ¤ ê²½ë¡œ í›„ë³´: í˜„ì¬ í´ë”, ìƒëŒ€, í”„ë¡œì íŠ¸ ë£¨íŠ¸
  var basePath = location.pathname.replace(/\/[^\/]*$/, '/');
  var BASES = ['', './', basePath, '/'];

  // í›„ë³´ URL ëª©ë¡ ë§Œë“¤ê¸°
  var CANDIDATES = [];
  BASES.forEach(function(b){ NAMES.forEach(function(n){ CANDIDATES.push(b + n); }); });

  function preload(url){
    return new Promise(function(res, rej){
      var t = new Image();
      t.onload = function(){ res(url); };
      t.onerror = rej;
      t.src = url;
    });
  }

  async function pickWorkingUrl(){
    for (var i=0; i<CANDIDATES.length; i++){
      try { return await preload(CANDIDATES[i]); }
      catch(_) {}
    }
    return null;
  }

  async function applyOnce(img){
    // ì´ë¯¸ ì •ìƒ ë¡œë“œë©´ ìŠ¤í‚µ
    if (img.complete && img.naturalWidth > 0) return;

    // ê¸°ì¡´ ë¡œë”ë“¤ê³¼ì˜ ê²½í•©ì„ í”¼í•˜ê¸° ìœ„í•´ srcset ì œê±° & ê°€ì‹œí™”
    img.removeAttribute('srcset');
    img.style.visibility = 'visible';

    // ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ” ê²½ë¡œë§Œ ì„ íƒ
    var ok = await pickWorkingUrl();
    if (!ok){
      var box = img.closest('.footer-logo'); if (box) box.style.display = 'none';
      return;
    }

    // http(s)ì—ì„œë§Œ ìºì‹œë²„ìŠ¤í„° ë¶€ì—¬ (file:// ì—ì„  ì ˆëŒ€ ë¶™ì´ì§€ ì•ŠìŒ)
    img.src = isHTTP ? (ok + '?v=' + Date.now()) : ok;

    // iOS ë Œë” ì•ˆì •í™” íŒíŠ¸
    requestAnimationFrame(function(){
      try{
        if (img.naturalWidth && img.naturalHeight){
          img.setAttribute('width',  img.naturalWidth);
          img.setAttribute('height', img.naturalHeight);
        }
        img.style.willChange = 'transform';
        img.style.transform  = 'translateZ(0)';
      }catch(e){}
    });
  }

  function boot(){
    var logos = document.querySelectorAll('.footer-logo .footer-logo-img');
    if(!logos.length) return;
    logos.forEach(applyOnce);
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', boot);
  } else {
    boot();
  }

  // ë””ë²„ê¹… í—¬í¼ (ëª¨ë°”ì¼ ì½˜ì†”ì—ì„œ ì‹¤í–‰)
  window.DEBUG_LOGO = function(){
    var im = document.querySelector('#intro .footer-logo-img') || document.querySelector('.footer-logo-img');
    if(!im) return console.log('no logo img');
    console.log('[DIMO] src:', im.src, 'complete:', im.complete, 'natural:', im.naturalWidth+'x'+im.naturalHeight);
  };
})();
</script>

<style>
/* ëª¨ë°”ì¼ì—ì„œ ë¹„ë””ì˜¤/í™ˆë°”ì— ê°€ë¦¬ì§€ ì•Šë„ë¡ ì¸íŠ¸ë¡œ ë¡œê³ ë¥¼ ìµœìƒë‹¨ ê³ ì • */
@media (max-width: 600px){
  #intro .footer-logo{
    position: fixed !important;
    left: 50% !important;
    transform: translateX(-50%) !important; /* ìŠ¤ì¼€ì¼ ë“± ì¶©ëŒ ë°©ì§€: ìœ„ì¹˜ë§Œ ê°•ì œ */
    bottom: calc(14px + env(safe-area-inset-bottom)) !important;
    width: 70vw !important;
    height: auto !important;
    z-index: 10000 !important;
    pointer-events: none !important;
    display: block !important;
    visibility: visible !important;
  }
}
</style>
<!-- ===== /DIMO MOBILE LOGO FINAL PATCH ===== -->
<!-- ===== DIMO FORM SUBMIT (Google Form ì—°ê²°) ===== -->
<script>
(function(){
  const FORM_ID = "1FAIpQLSdvbkYC3PN-jxohnd8eH7ylubpzpoeH_xO2tITHbieQXir5Qw";
  const ENTRY = {
    title:      "entry.852986993",   // ì•„ì´ë””ì–´ì œëª©
    inventor:   "entry.1250203782",  // ë°œëª…ìëª…
    compliment: "entry.1747730481"   // ì¹­ì°¬ë¬¸êµ¬
  };

  window.DIMO_SUBMIT = function(data){
    try {
      const url = `https://docs.google.com/forms/d/e/${FORM_ID}/formResponse`;
      const params = new URLSearchParams();

      if (data.title)      params.append(ENTRY.title, data.title);
      if (data.inventor)   params.append(ENTRY.inventor, data.inventor);
      if (data.compliment) params.append(ENTRY.compliment, data.compliment);

      fetch(url, {
        method: "POST",
        mode: "no-cors",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: params.toString()
      });

      console.log("âœ… DIMO: êµ¬ê¸€í¼ ìë™ ì €ì¥ ì™„ë£Œ!");
    } catch (e) {
      console.error("âŒ DIMO: êµ¬ê¸€í¼ ì œì¶œ ì˜¤ë¥˜", e);
    }
  };
})();
</script>
<!-- ===== /DIMO FORM SUBMIT ===== -->

</body>
</html>
